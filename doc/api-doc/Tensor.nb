(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    300843,       9463]
NotebookOptionsPosition[    276301,       8665]
NotebookOutlinePosition[    280813,       8798]
CellTagsIndexPosition[    279641,       8765]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Tensor Documentation", "Chapter",
 CellChangeTimes->{{3.6333515346579514`*^9, 3.63335154627586*^9}, {
  3.633364320690548*^9, 3.63336432261762*^9}, {3.633781291117386*^9, 
  3.633781292159832*^9}, {3.633781364287074*^9, 3.633781398056273*^9}, {
  3.6337814322542763`*^9, 3.633781447268347*^9}}],

Cell[CellGroupData[{

Cell["Preamble", "Subsection",
 CellChangeTimes->{{3.6363790514552937`*^9, 3.636379052454998*^9}}],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Tensor`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.633351696261045*^9, 3.633351701530016*^9}, {
  3.633781146956828*^9, 3.633781148275402*^9}, {3.633781294331254*^9, 
  3.633781296275483*^9}, {3.633781369011711*^9, 3.633781370275049*^9}, {
  3.633781401233733*^9, 3.633781450090982*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.6351824420646763`*^9, 3.635182446927919*^9}}],

Cell[BoxData[
 ButtonBox["\<\"Open Source Code\"\>",
  Appearance->Automatic,
  ButtonFunction:>(Needs["QUDevTools`"]; NotebookOpen[
     FileNameJoin[{QUDevTools`$QUSourcePath, 
       StringJoin[
        FileBaseName[
         NotebookFileName[]], ".m"]}]]),
  Evaluator->Automatic,
  Method->"Preemptive"]], "Output",
 CellChangeTimes->{{3.635182609676621*^9, 3.6351826444407997`*^9}, {
  3.635182842680962*^9, 3.63518284820653*^9}, {3.635182903083259*^9, 
  3.635182906619155*^9}, {3.635182952870352*^9, 3.635182956778173*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Introduction and Overview", "Section",
 CellChangeTimes->{{3.633351563673402*^9, 3.633351567143589*^9}}],

Cell["\<\
This package contains functions for constructing, manipulating and \
contracting states and operators of multipartite systems.\
\>", "Text",
 CellChangeTimes->{{3.634310050150309*^9, 3.634310208369714*^9}, {
  3.634349792591257*^9, 3.6343498682815647`*^9}, {3.634349914343247*^9, 
  3.634349956255692*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrices and Matrix operations", "Section",
 CellChangeTimes->{{3.633352040880207*^9, 3.633352042744746*^9}, {
  3.634310557380536*^9, 3.634310559663636*^9}, {3.6343107475388527`*^9, 
  3.634310749520076*^9}}],

Cell[CellGroupData[{

Cell["CircleTimes", "Subsection",
 CellChangeTimes->{{3.6343107215521727`*^9, 3.634310729011115*^9}}],

Cell[TextData[{
 StyleBox["CircleTimes[", "Input"],
 StyleBox["v1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["vn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the vector formed by taking the tensor product of all vectors ",
 StyleBox["v1\[CircleTimes]v2\[CircleTimes]..\[CircleTimes]vn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["op1,..,opn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the Array from taking the tensor product of arrays ",
 StyleBox["op1\[CircleTimes]op2\[CircleTimes]..\[CircleTimes]opn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".\n",
  FontSlant->"Italic"],
 "\n",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["op\[Rule]n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns ",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " for n copies of ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".\n\n",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Notes",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 StyleBox["\n\[Bullet]",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" CircleTimes", "Input"],
 StyleBox[" can be shorthanded with the symbol \[CircleTimes], which can be \
typed using the keybard sequence ",
  FontWeight->"Plain"],
 StyleBox["Esc ",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]],
 StyleBox["c*", "Input",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]],
 StyleBox[" Esc",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311328002417*^9, {3.634316418526174*^9, 3.634316521790423*^9}, {
   3.634509526888596*^9, 3.634509548646995*^9}, {3.634924751102474*^9, 
   3.634924781111176*^9}, {3.6349258561999493`*^9, 3.6349259526860847`*^9}, {
   3.634926269549931*^9, 3.6349262813179913`*^9}, {3.634989908112784*^9, 
   3.634989908825219*^9}},
 CellTags->"CircleTimes::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343166954591093`*^9, 3.6343166962902393`*^9}}],

Cell["Tensor product of two vectors", "Text",
 CellChangeTimes->{{3.634316716247079*^9, 3.634316719757729*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}], "\[CircleTimes]", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.634316705064439*^9, 3.634316711039897*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6343167114914417`*^9, {3.6349256373455343`*^9, 3.634925662996464*^9}, 
   3.634925782933961*^9, {3.636379106075409*^9, 3.636379114965309*^9}}]
}, Open  ]],

Cell["Tensor product of 3 X-gates", "Text",
 CellChangeTimes->{{3.634316724324832*^9, 3.634316734754912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleTimes", "[", 
   RowBox[{
    RowBox[{"TP", "[", "X", "]"}], "->", "3"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634316736393165*^9, 3.634316745949678*^9}, {
  3.634925672944572*^9, 3.634925676697356*^9}, {3.6349257560983973`*^9, 
  3.634925757735321*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "1"},
     {"0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343167426883574`*^9, 3.63431674631463*^9}, {
   3.6349256387277813`*^9, 3.634925677352037*^9}, 3.634925783686665*^9, {
   3.636379106100148*^9, 3.6363791149959383`*^9}}]
}, Open  ]],

Cell["Tensor product of vector with matrix", "Text",
 CellChangeTimes->{{3.6349258070959587`*^9, 3.634925815256929*^9}, {
  3.634925985510036*^9, 3.634925988324211*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TP", "[", "X", "]"}], "\[CircleTimes]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6349258345499163`*^9, 3.634925843931487*^9}, {
  3.634925990716626*^9, 3.634925992455914*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", "1"},
     {"0", "0"},
     {"1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634925844215228*^9, 3.634925992789897*^9, {3.636379106139431*^9, 
   3.63637911501823*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[DoubleStruckOne] (IdentityMatrix)", "Subsection",
 CellChangeTimes->{{3.6349234964072857`*^9, 3.634923520445619*^9}, 
   3.634923834856448*^9}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckOne]", "n"], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "is shorthand for ",
 StyleBox["IdentityMatrix[n]", "Input"],
 ". The symbol \[DoubleStruckOne] can be typed using the sequence ",
 StyleBox[" ", "Input"],
 StyleBox[Cell[TextData[StyleBox["Esc", "Text",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]]], "Input"], "Input"],
 StyleBox["\[ThinSpace]ds1\[ThinSpace]", "Input"],
 StyleBox[Cell[TextData[StyleBox["Esc", "Text",
  FontWeight->"Plain",
  Background->RGBColor[1, 1, 0.85]]], "Input"], "Input"],
 ", and the subscript can be initiated with the shortcut ",
 StyleBox["Ctrl+Shift+_",
  Background->RGBColor[1, 1, 0.85]],
 ". The expression ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckOne]", "n"], " "}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "in ",
 StyleBox["FullForm", "Input"],
 " is given by ",
 StyleBox["Subscript[\[DoubleStruckOne],n]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634923522706259*^9, 3.6349235857598047`*^9}, {
  3.63492362725347*^9, 3.634923803415079*^9}, {3.634924679103196*^9, 
  3.634924723178679*^9}, {3.6349247862955637`*^9, 3.634924826013873*^9}, {
  3.634924907487076*^9, 3.634924909096919*^9}, {3.634926004459416*^9, 
  3.634926005281067*^9}, {3.6349262878205147`*^9, 3.634926313679575*^9}, {
  3.634989898160452*^9, 3.6349898986805487`*^9}, {3.634990086887166*^9, 
  3.634990113203055*^9}},
 CellTags->"IdentityMatrixShorthand::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6349238410359*^9, 3.6349238417549543`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox["\[DoubleStruckOne]", "3"]], "Input",
 CellChangeTimes->{{3.634923844289794*^9, 3.6349238476497107`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634925051503069*^9, {3.6349257884952908`*^9, 3.634925792769113*^9}, 
   3.634926121046321*^9, 3.634989959295082*^9, {3.636379106180766*^9, 
   3.636379115051602*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TP", "[", "X", "]"}], "\[CircleTimes]", 
   SubscriptBox["\[DoubleStruckOne]", "2"]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634989938443746*^9, 3.6349899687492857`*^9}, {
  3.634990049365137*^9, 3.63499005744967*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6349899456914253`*^9, 3.634989969558889*^9}, {
  3.6349900556366987`*^9, 3.6349900578973103`*^9}, {3.636379106222805*^9, 
  3.6363791150852327`*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorFactorPermutations", "Subsection",
 CellChangeTimes->{{3.634310810427404*^9, 3.634310812373498*^9}, 
   3.634310973563674*^9, {3.635360614997547*^9, 3.635360615658964*^9}, {
   3.6355564122941513`*^9, 3.635556412956675*^9}}],

Cell[TextData[{
 StyleBox["TensorFactorPermutations[{", "Input"],
 StyleBox["A1,n1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["A2,n2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...,{", "Input"],
 StyleBox["Ak,nk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns a sum of all permutations of ",
 StyleBox["CircleTimes", "Input"],
 " of ",
 StyleBox["nj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " copies of ",
 StyleBox["Aj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ", for j=1 to n. This function also works with symbolic expresions.\n\n",
 StyleBox["TensorFactorPermutations[", "Input"],
 StyleBox["A1\[Rule]n1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["A2\[Rule]n2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["Ak\[Rule]nk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " also returns the same result as ",
 StyleBox["TensorFactorPermutations[{", "Input"],
 StyleBox["A1,n1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["A2,n2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...,{", "Input"],
 StyleBox["Ak,nk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343112851955433`*^9, {3.634316561728455*^9, 3.634316588222616*^9}, {
   3.635360618067092*^9, 3.6353606305235567`*^9}, {3.6355564144992743`*^9, 
   3.63555650467117*^9}},
 CellTags->"TensorFactorPermutations::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634316596154511*^9, 3.634316596840386*^9}}],

Cell["To return \
X\[CircleTimes]I\[CircleTimes]I+I\[CircleTimes]X\[CircleTimes]I+I\
\[CircleTimes]I\[CircleTimes]X", "Text",
 CellChangeTimes->{{3.634316626433573*^9, 3.634316649556919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorFactorPermutations", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TP", "[", "\"\<I\>\"", "]"}], ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TP", "[", "\"\<X\>\"", "]"}], ",", "1"}], "}"}]}], "]"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634316597826398*^9, 3.634316622344578*^9}, {
  3.635360769721298*^9, 3.635360797949656*^9}, {3.6355565321328907`*^9, 
  3.6355565327700987`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "1", "0", "1", "0", "0", "0"},
     {"1", "0", "0", "1", "0", "1", "0", "0"},
     {"1", "0", "0", "1", "0", "0", "1", "0"},
     {"0", "1", "1", "0", "0", "0", "0", "1"},
     {"1", "0", "0", "0", "0", "1", "1", "0"},
     {"0", "1", "0", "0", "1", "0", "0", "1"},
     {"0", "0", "1", "0", "1", "0", "0", "1"},
     {"0", "0", "0", "1", "0", "1", "1", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6353607707777443`*^9, 3.6353607983044767`*^9}, 
   3.6355568880179653`*^9, {3.636379106257029*^9, 3.636379115136002*^9}}]
}, Open  ]],

Cell["Or using symbolic expressions", "Text",
 CellChangeTimes->{{3.6353606464368057`*^9, 3.635360648612014*^9}, {
  3.6353607629235697`*^9, 3.635360767579808*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TensorFactorPermutations", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<X\>\"", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<\[DoubleStruckOne]\>\"", ",", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TensorFactorPermutations", "[", 
  RowBox[{
   RowBox[{"\"\<X\>\"", "\[Rule]", "1"}], ",", 
   RowBox[{"\"\<\[DoubleStruckOne]\>\"", "\[Rule]", "2"}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.6353606537615128`*^9, 3.63536065890534*^9}, {
  3.635360745637351*^9, 3.635360776396965*^9}, {3.635556535217918*^9, 
  3.635556535841762*^9}, {3.635556906621513*^9, 3.6355569262453823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>", 
   "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>"}], "+", 
  RowBox[{"\<\"\[DoubleStruckOne]\"\>", "\[CircleTimes]", "\<\"X\"\>", 
   "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>"}], "+", 
  RowBox[{"\<\"\[DoubleStruckOne]\"\>", 
   "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>", 
   "\[CircleTimes]", "\<\"X\"\>"}]}]], "Output",
 CellChangeTimes->{{3.635360755193564*^9, 3.6353607767080307`*^9}, 
   3.635556668702347*^9, {3.635556914637003*^9, 3.635556927341522*^9}, {
   3.6363791062949877`*^9, 3.6363791151824627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>", 
   "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>"}], "+", 
  RowBox[{"\<\"\[DoubleStruckOne]\"\>", "\[CircleTimes]", "\<\"X\"\>", 
   "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>"}], "+", 
  RowBox[{"\<\"\[DoubleStruckOne]\"\>", 
   "\[CircleTimes]", "\<\"\[DoubleStruckOne]\"\>", 
   "\[CircleTimes]", "\<\"X\"\>"}]}]], "Output",
 CellChangeTimes->{{3.635360755193564*^9, 3.6353607767080307`*^9}, 
   3.635556668702347*^9, {3.635556914637003*^9, 3.635556927341522*^9}, {
   3.6363791062949877`*^9, 3.636379115192905*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["SwapMatrix", "Subsection",
 CellChangeTimes->{{3.63431080413785*^9, 3.634310805342319*^9}, 
   3.634310974879772*^9}],

Cell[TextData[{
 StyleBox["SwapMatrix[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the permutation matrix for mapping a subsystem ",
 StyleBox["k", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with dimension ",
 StyleBox["dk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ", to subsystem ",
 StyleBox["ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["SwapMatrix[", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}] ", "Input"],
 "returns the permutation matrix for mapping a subsystem ",
 StyleBox["k", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to subsystem ",
 StyleBox["ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where all subsystems have dimension ",
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["SwapMatrix[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},SparseArray]", "Input"],
 "and ",
 StyleBox["SwapMatrix[", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},SparseArray] ", "Input"],
 "returns the permutation matrix as a ",
 StyleBox["SparseArray", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311280729559*^9, 3.634316794434973*^9, {3.6343168269251223`*^9, 
   3.634316915295806*^9}},
 CellTags->"SwapMatrix::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634316756669258*^9, 3.634316757344146*^9}}],

Cell["2-qubit Swap gate", "Text",
 CellChangeTimes->{{3.634316758580884*^9, 3.634316764622871*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SwapMatrix", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6343167658167562`*^9, 3.634316784940782*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634316771475271*^9, 3.634316785144226*^9}, {
  3.636379106335595*^9, 3.636379115232444*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["BlockMatrix", "Subsection",
 CellChangeTimes->{{3.6343107352332087`*^9, 3.634310736975686*^9}, 
   3.6343109763759604`*^9}],

Cell[TextData[{
 StyleBox["BlockMatrix[", "Input"],
 StyleBox["B1,B2,...,Bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the diagonal block matrix of the input matrices ",
 StyleBox["B1,B2,...,Bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343113232100773`*^9, {3.6343170399354277`*^9, 3.6343170789715157`*^9}},
 CellTags->"BlockMatrix::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634317084360384*^9, 3.6343170850700483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BlockMatrix", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Array", "[", 
     RowBox[{"c", ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317085840761*^9, 3.634317115276587*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"b", "[", 
       RowBox[{"1", ",", "1"}], "]"}], 
      RowBox[{"b", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "0", "0", "0"},
     {"0", 
      RowBox[{"b", "[", 
       RowBox[{"2", ",", "1"}], "]"}], 
      RowBox[{"b", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "1"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "2"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"1", ",", "3"}], "]"}]},
     {"0", "0", "0", 
      RowBox[{"c", "[", 
       RowBox[{"2", ",", "1"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"2", ",", "2"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"2", ",", "3"}], "]"}]},
     {"0", "0", "0", 
      RowBox[{"c", "[", 
       RowBox[{"3", ",", "1"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"3", ",", "2"}], "]"}], 
      RowBox[{"c", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634317115675673*^9, {3.636379106368162*^9, 3.636379115264061*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["UnitArray", "Subsection",
 CellChangeTimes->{{3.634310781740144*^9, 3.634310784765884*^9}, {
  3.634310977647337*^9, 3.634310979987252*^9}}],

Cell[TextData[{
 StyleBox["UnitArray[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the unit rank-",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " array of dimension ",
 StyleBox["{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " with a 1 at index ",
 StyleBox["{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " and zeros elsewhere.\n",
 StyleBox["UnitArray[{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,...,in", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}, SparseArray]", "Input"],
 " returns the unit array as a ",
 StyleBox["SparseArray", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311290955184*^9, {3.634317188314958*^9, 3.634317226280287*^9}},
 CellTags->"UnitArray::usage"],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.634317232140891*^9, 3.634317233052122*^9}}],

Cell["Elementary Matrix", "Text",
 CellChangeTimes->{{3.634317236797583*^9, 3.634317240544561*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"UnitArray", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6343172337674093`*^9, 3.634317252155806*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {"0", "0", "1"},
     {"0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634317252522203*^9, {3.6363791064001637`*^9, 3.63637911529951*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Com and ACom", "Subsection",
 CellChangeTimes->{{3.634310739888934*^9, 3.6343107593858128`*^9}, {
  3.6343114120583*^9, 3.634311416084159*^9}}],

Cell[TextData[{
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the commutator ",
 StyleBox["[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]=", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["-", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n",
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the nested commutator",
 StyleBox["  [", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]...]]=Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n-1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]]", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where ",
  FontWeight->"Plain"],
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",0]=", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", and ",
  FontWeight->"Plain"],
 StyleBox["Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",1]=Com[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311311339786*^9, {3.634317277413248*^9, 3.63431748303874*^9}, {
   3.634317529357958*^9, 3.634317531898181*^9}, {3.634317597260312*^9, 
   3.634317598476801*^9}},
 CellTags->"Com::usage"],

Cell[TextData[{
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the anti-commutator ",
 StyleBox["{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}=", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["+", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n",
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the nested anti-commutator",
 StyleBox[" {", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}...}}=ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",ACom{", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n-1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]]", "Input"],
 "of matrices ",
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where ",
  FontWeight->"Plain"],
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",0]=", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", and ",
  FontWeight->"Plain"],
 StyleBox["ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",1]=ACom[", "Input"],
 StyleBox["A", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311316190063*^9, {3.634317539732061*^9, 3.6343176165458317`*^9}},
 CellTags->"ACom::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343177063640203`*^9, 3.6343177075006657`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"TP", "[", "X", "]"}], ",", 
    RowBox[{"TP", "[", "Y", "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317709973526*^9, 3.634317719470849*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"2", " ", "\[ImaginaryI]"}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634317715374281*^9, 3.634317719810995*^9}, {
  3.636379106425392*^9, 3.636379115333067*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Com", "[", 
   RowBox[{
    RowBox[{"TP", "[", "X", "]"}], ",", 
    RowBox[{"TP", "[", "Y", "]"}], ",", "3"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317720838813*^9, 3.634317733713531*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"8", " ", "\[ImaginaryI]"}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "8"}], " ", "\[ImaginaryI]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634317726407619*^9, 3.634317734061287*^9}, {
  3.636379106470521*^9, 3.636379115355241*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["OuterProduct and Projector", "Subsection",
 CellChangeTimes->{{3.634310765820191*^9, 3.6343107737409554`*^9}, {
  3.634310982597848*^9, 3.63431099021356*^9}}],

Cell[TextData[{
 StyleBox["OuterProduct[", "Input"],
 StyleBox["vec1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["vec2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the matrix ",
 StyleBox["vec1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[CircleTimes]", "Input"],
 StyleBox["vec2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[HermitianConjugate]", "Input"],
 " formed by taking the outer product of two vectors ",
 StyleBox["vec1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["vec2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". The ",
 StyleBox["vecj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be either a vectors, column vector, or row vector.\n\n",
 StyleBox["OuterProduct[", "Input"],
 StyleBox["mat1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["mat2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the matrix ",
 StyleBox["Vec[", "Input"],
 StyleBox["mat1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]\[CircleTimes]Vec[", "Input"],
 StyleBox["mat2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]\[HermitianConjugate]", "Input"],
 " formed by taking the outer product of the vectors formed by vectorizing \
two matrices ",
 StyleBox["mat1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["mat2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343113040391827`*^9, {3.634317627433009*^9, 3.6343176544229927`*^9}, {
   3.638275810980434*^9, 3.63827589633395*^9}, {3.638277349509069*^9, 
   3.6382773718950157`*^9}},
 CellTags->"OuterProduct::usage"],

Cell[CellGroupData[{

Cell["Example 1: Vectors", "Subsubsection",
 CellChangeTimes->{{3.638276534466221*^9, 3.638276540148806*^9}, {
  3.638277540835432*^9, 3.638277540926499*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OuterProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.638276541467911*^9, 3.6382765532221117`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]},
     {
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6382765502064867`*^9, 3.638276553594541*^9}}]
}, Open  ]],

Cell["We can also use column vectors", "Text",
 CellChangeTimes->{{3.638276558968792*^9, 3.63827656196208*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OuterProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", 
      RowBox[{"{", "b", "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"{", "d", "}"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6382765551235847`*^9, 3.638276573517181*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]},
     {
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.638276570400416*^9, 3.6382765738345222`*^9}}]
}, Open  ]],

Cell["... and row vectors", "Text",
 CellChangeTimes->{{3.6382773898162003`*^9, 3.63827739521607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OuterProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b"}], "}"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"c", ",", "d"}], "}"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.638277401759432*^9, 3.6382774039296207`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]},
     {
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.638277404662006*^9}]
}, Open  ]],

Cell["... and mix and match any of the above", "Text",
 CellChangeTimes->{{3.638276576002605*^9, 3.638276582673465*^9}, {
  3.6382774089177017`*^9, 3.638277412732279*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OuterProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "c", "}"}], ",", 
      RowBox[{"{", "d", "}"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.638276584100603*^9, 3.6382765986049433`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"a", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]},
     {
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "c", "]"}]}], 
      RowBox[{"b", " ", 
       RowBox[{"Conjugate", "[", "d", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6382765941829557`*^9, 3.638276598952791*^9}, 
   3.6382774148930683`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2: Matrices", "Subsubsection",
 CellChangeTimes->{{3.638277417737211*^9, 3.6382774216631937`*^9}, {
  3.638277538328162*^9, 3.638277538406478*^9}}],

Cell[TextData[{
 "OuterProduct works with matrices by vectorizing the matrices then taking \
the outer product (See ",
 ButtonBox["Vec",
  BaseStyle->"Hyperlink",
  ButtonData->"Vec::usage"],
 ")."
}], "Text",
 CellChangeTimes->{{3.638277423722287*^9, 3.638277458058772*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OuterProduct", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.638277433286701*^9, 3.6382774722567177`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6382774689892263`*^9, 3.63827747261339*^9}}]
}, Open  ]],

Cell["We can also mix and match between vectors and matirces", "Text",
 CellChangeTimes->{{3.638277477959115*^9, 3.6382774862509317`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OuterProduct", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", "2"}], "]"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6382774881430817`*^9, 3.6382775248623457`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "1"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "2"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"b", "[", "2", "]"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.638277500068099*^9, 3.638277525160861*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Projector", "Subsection",
 CellChangeTimes->{{3.638276531238823*^9, 3.638276532352119*^9}}],

Cell[TextData[{
 StyleBox["Projector[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "returns the rank-1 projector ",
 StyleBox["OuterProduct[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ", where ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be either a vector or matrix.\n\n",
 StyleBox["Projector[", "Input"],
 StyleBox["op1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["op2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...]", "Input"],
 " returns the  rank-1 projector formed by summing the projectors ",
 StyleBox["Projector[", "Input"],
 StyleBox["opj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ".\n\n",
 StyleBox["Projector[", "Input"],
 StyleBox["args", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",SparseArray]", "Input"],
 " returns the projector as a ",
 StyleBox["SparseArray", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311297818637*^9, {3.634317662364491*^9, 3.6343176913780212`*^9}, {
   3.638275977570819*^9, 3.6382761957974777`*^9}, {3.6382773257577667`*^9, 
   3.6382773280541277`*^9}, {3.638277582373672*^9, 3.63827759048136*^9}},
 CellTags->"Projector::usage"],

Cell[CellGroupData[{

Cell["Example 1: Vectors", "Subsubsection",
 CellChangeTimes->{{3.6343177439169188`*^9, 3.634317744603284*^9}, {
  3.6382762669640923`*^9, 3.638276271622007*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Projector", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "3"}], "]"}], "]"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634317758675139*^9, 3.6343177708515463`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}], "2"], 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "2", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "3", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{"a", "[", "2", "]"}], "]"}], "2"], 
      RowBox[{
       RowBox[{"a", "[", "2", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "3", "]"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "1", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", "3", "]"}], " ", 
       RowBox[{"Conjugate", "[", 
        RowBox[{"a", "[", "2", "]"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{"a", "[", "3", "]"}], "]"}], "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634317765181858*^9, 3.634317771158102*^9}, {
  3.636379106615664*^9, 3.636379115454665*^9}}]
}, Open  ]],

Cell["Return a low rank projector as a sparse array", "Text",
 CellChangeTimes->{{3.638276246917562*^9, 3.638276255017253*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Projector", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", "SparseArray"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6382762222748137`*^9, 3.6382762854263477`*^9}}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBggWIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPikPE
d3YbuO7c8sL+hvvydTXT3tqfjMj9F//1PdXMBwAgVM3Z
                "], {{0, 0}, {4, 
                4}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False,
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBggWIQ26p8d9wspXP2c4wXbTH/ccX+xSLFx4GrXtmPikPE
d3YbuO7c8sL+hvvydTXT3tqfjMj9F//1PdXMBwAgVM3Z
                "], {{0, 0}, {4, 
                4}}, {0, 1}], AspectRatio -> 1, Axes -> False, Frame -> False,
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.0625`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "1", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}}, GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<1>, {4, 4}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.638276227092503*^9, 3.638276281537743*^9}}]
}, Open  ]],

Cell["Projectors for a set of vectors:", "Text",
 CellChangeTimes->{{3.63827628876644*^9, 3.6382763006807537`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Projector", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1"}], ",", "0"}], "}"}], "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.638276302363063*^9, 3.6382763529385357`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "2"], ",", 
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", 
     FractionBox["1", "2"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", "0", ",", 
     FractionBox["3", "2"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6382763487649612`*^9, 3.638276355491982*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2: Matrices", "Subsubsection",
 CellChangeTimes->{{3.638276367979233*^9, 3.638276371409638*^9}}],

Cell[TextData[{
 "Projector also works with matrices by vectorizing the matrices (See ",
 ButtonBox["Vec",
  BaseStyle->"Hyperlink",
  ButtonData->"Vec::usage"],
 ")."
}], "Text",
 CellChangeTimes->{{3.6382763729500923`*^9, 3.6382764405290623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Projector", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "/", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.638276442090805*^9, 3.6382764664840612`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}], ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6382764595423603`*^9, 3.638276466819737*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor Product Parser", "Section",
 CellChangeTimes->{{3.634310871446907*^9, 3.634310874991136*^9}}],

Cell[CellGroupData[{

Cell["TP Parser", "Subsection",
 CellChangeTimes->{{3.634310887276719*^9, 3.634310891236371*^9}}],

Cell[TextData[{
 StyleBox["TP[", "Input"],
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " parses an input expression and returns the tensor product of matrices with \
appropriate coefficients. Allowed operators are ",
 StyleBox["+ - *", "Input"],
 " for addition and subtraction, and scalar multiplication, numbers or \
symbols for scalar factors, ",
 StyleBox["i", "Input"],
 " for for the imaginary number and any expressions to be converted to Arrays \
as specified specified by the option ",
 StyleBox["Replace", "Input"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet] ",
 StyleBox["Replace\[Rule]", "Input"],
 StyleBox["rules", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ", "Input"],
 "specifies the strings to be replaced by matrices. It must be a list of \
Rules  ",
 StyleBox["str", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[Rule]", "Input"],
 StyleBox["op ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "where ",
 StyleBox["str", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " is a ",
 StyleBox["String", "Input"],
 "  and ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " is the operator the string will be replaced by in ",
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". The default includes the identity (I), Pauli X,Y,Z, Hadamard (H), phase \
(S), and \[Pi]/8 (T) gates, and projectors |0\[RightAngleBracket]\
\[LeftAngleBracket]0| (P), and |1\[RightAngleBracket]\[LeftAngleBracket]1| \
(M) and is given by:\n",
 StyleBox["{\[OpenCurlyDoubleQuote]I\[CloseCurlyDoubleQuote]\[Rule]\
PauliMatrix[0], \
\[OpenCurlyDoubleQuote]X\[CloseCurlyDoubleQuote]\[Rule]PauliMatrix[1],\
\[CloseCurlyDoubleQuote]Y\[CloseCurlyDoubleQuote]\[Rule]PauliMatrix[2],\
\[CloseCurlyDoubleQuote]Z\[CloseCurlyDoubleQuote]\[Rule]PauliMatrix[3], \
\[OpenCurlyDoubleQuote]P\[CloseCurlyDoubleQuote]\[Rule]{{0,1},{0,0}}, \
\[OpenCurlyDoubleQuote]M\[CloseCurlyDoubleQuote]\[Rule]{{0,0},{1,0}}, \
\[OpenCurlyDoubleQuote]U\[CloseCurlyDoubleQuote]\[Rule]{{1,0},{0,0}}, \
\[OpenCurlyDoubleQuote]D\[CloseCurlyDoubleQuote]\[Rule]{{0,0},{0,1}}, \
\[CloseCurlyDoubleQuote]H\[CloseCurlyDoubleQuote]\[Rule]{{1,1},{1,-1}}/Sqrt[2]\
, \[OpenCurlyDoubleQuote]S\[CloseCurlyDoubleQuote]\[Rule]{{1,0},{0,I}}, \
\[OpenCurlyDoubleQuote]T\[CloseCurlyDoubleQuote]\[Rule]{{1,0},{0,Exp[I*Pi/4]}}\
}", "Input"],
 ".\n\n\[Bullet] ",
 StyleBox["Method\[Rule]", "Input"],
 StyleBox["fun", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the function ",
 StyleBox["fun", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to be used by TP to combine operators. The default value is ",
 StyleBox["CircleTimes", "Input"],
 ".\n\n",
 StyleBox["Attributes",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n",
 StyleBox["TP", "Input"],
 " has attributes ",
 StyleBox["HoldFirst", "Input"],
 " and immediately converts the input ",
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into a string before any evaluation occurs. Hence ",
 StyleBox["expr", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a string, or an expression of symbols and in the later case it will \
ignore any definitions associated to those symbols."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634310902718301*^9, {3.6343253345275593`*^9, 3.634326004885202*^9}, {
   3.634326069793248*^9, 3.634326071279565*^9}, {3.634326105259543*^9, 
   3.6343262298426027`*^9}},
 CellTags->"TP::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.6343109070325747`*^9, 3.6343109076839952`*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Method", "CircleTimes", 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "function", " ", "used", " ", "to", " ", 
      "combine", " ", "elements", " ", "in", " ", "the", " ", "TP", " ", 
      RowBox[{"parser", "."}]}], "Text"]},
   {"Replace", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<X\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Y\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "\[ImaginaryI]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[ImaginaryI]", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<Z\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<I\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<P\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<M\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<U\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<D\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<H\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["2"]], ",", 
           FractionBox["1", 
            SqrtBox["2"]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["2"]], ",", 
           RowBox[{"-", 
            FractionBox["1", 
             SqrtBox["2"]]}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<S\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[ImaginaryI]"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"\"\<T\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}], "}"}]}], 
        "}"}]}]}], "}"}], 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "replacement", " ", "rules", " ", "for", 
      " ", "parsing", " ", "an", " ", "input", " ", 
      RowBox[{"expression", "."}]}], "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634326024046686*^9, 3.6343260512004957`*^9}, {
  3.6343260815569143`*^9, 3.634326094074238*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634310908943316*^9, 3.634310909978795*^9}, {
  3.634326355797537*^9, 3.634326355971631*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TP", "[", 
   RowBox[{"aXX", "+", "bYY"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634325438997239*^9, 3.6343254403526506`*^9}, {
  3.634326237079976*^9, 3.634326257987918*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", 
      RowBox[{"a", "-", "b"}]},
     {"0", "0", 
      RowBox[{"a", "+", "b"}], "0"},
     {"0", 
      RowBox[{"a", "+", "b"}], "0", "0"},
     {
      RowBox[{"a", "-", "b"}], "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634325440699271*^9, {3.6343262519623117`*^9, 3.6343262584822617`*^9}, {
   3.6363791067404127`*^9, 3.636379115516766*^9}}]
}, Open  ]],

Cell["\<\
If no defined inputs are detected everything is treated as multiplication\
\>", "Text",
 CellChangeTimes->{{3.634326363970717*^9, 3.634326384619246*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TP", "[", 
  RowBox[{"abc", "+", 
   RowBox[{"3", "xy"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.634326386476253*^9, 3.634326391109336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", "b", " ", "c"}], "+", 
  RowBox[{"3", " ", "x", " ", "y"}]}]], "Output",
 CellChangeTimes->{
  3.634326391718445*^9, {3.636379106766568*^9, 3.636379115550107*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix-Tensor Manipulations", "Section",
 CellChangeTimes->{{3.634310842692814*^9, 3.634310845707429*^9}}],

Cell[CellGroupData[{

Cell["MatrixToTensor", "Subsection",
 CellChangeTimes->{{3.6343111988578568`*^9, 3.6343112006351967`*^9}}],

Cell[TextData[{
 StyleBox["MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{{", "Input"],
 StyleBox["dL1,...,dLn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["dR1,...,dRk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}}]", "Input"],
 " transforms the matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with ",
 StyleBox["Dimensions", "Input"],
 " ",
 StyleBox["{", "Input"],
 StyleBox["dL1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["*...*", "Input"],
 StyleBox["dLn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["dR1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["*...*", "Input"],
 StyleBox["dRk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " into a a rank-",
 StyleBox["(n+k)", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " tensor.\n\n",
 StyleBox["MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " transforms the matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with ",
 StyleBox["Dimensions", "Input"],
 " ",
 StyleBox["{", "Input"],
 StyleBox["d1*...*dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["d1*...*dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " into a a rank-",
 StyleBox["2n.", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " transforms the matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with Flattened dimensions ",
 StyleBox["d1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["*...*", "Input"],
 StyleBox["dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into a a rank-",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " tensor."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311207861146*^9, {3.634318337804388*^9, 3.6343186029760647`*^9}},
 CellTags->"MatrixToTensor::usage"],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.634318670436749*^9, 3.6343186718608*^9}}],

Cell["\<\
Converting an array of mixed dimensional subsystems into a tensor:\
\>", "Text",
 CellChangeTimes->{{3.6343187059182367`*^9, 3.634318718117638*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixToTensor", "[", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ArrayDepth"}]}], "Input",
 CellChangeTimes->{{3.634318672517428*^9, 3.6343186951823807`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "6"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "6"}], "]"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "6"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "5"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "6"}], "]"}]}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6343186875628157`*^9, 3.634318695822191*^9}, {
  3.636379106806645*^9, 3.6363791155989113`*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.6343186875628157`*^9, 3.634318695822191*^9}, {
  3.636379106806645*^9, 3.6363791156054897`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsubsection",
 CellChangeTimes->{{3.634318721199524*^9, 3.6343187235505342`*^9}}],

Cell["Converting a bipartite matrix into a tensor", "Text",
 CellChangeTimes->{{3.634318727654437*^9, 3.634318733390873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixToTensor", "[", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ArrayDepth"}]}], "Input",
 CellChangeTimes->{{3.634318738705579*^9, 3.634318744185753*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}]}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}], ",", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.634318744701151*^9, {3.6363791068564377`*^9, 3.636379115650084*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.634318744701151*^9, {3.6363791068564377`*^9, 3.636379115655984*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MatrixTranspose", "Subsection",
 CellChangeTimes->{{3.634311211120685*^9, 3.634311212965885*^9}}],

Cell[TextData[{
 StyleBox["MatrixTranspose[", "Input"],
 StyleBox["mat,dims,perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " yields the matrix resulting from applying the tensor transpose descriped \
by ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to the multipartite matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". \n\[Bullet] ",
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the dimensions of subsystems and may be listed in any of the \
forms allowed by ",
 StyleBox["MatrixToTensor", "Input"],
 ".\n\[Bullet] ",
 StyleBox["perms", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " is the same argument as used by ",
 StyleBox["TensorTranspose", "Input"],
 " where the labelling of subsystem indicies starts from the first left-index \
thorugh to the last left-index followed by the first right index through to \
the last right-index."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311220033101*^9, {3.63431861120216*^9, 3.634318612888997*^9}, {
   3.634318779289822*^9, 3.6343188718604183`*^9}, {3.634319715596946*^9, 
   3.634319752645644*^9}, {3.634322530548225*^9, 3.634322804994173*^9}},
 CellTags->"MatrixTranspose::usage"],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.634322496819581*^9, 3.6343224981390543`*^9}}],

Cell["\<\
Implememt a partial transpose of subsystem 1 or a bipartite matrix:\
\>", "Text",
 CellChangeTimes->{{3.6343225001078463`*^9, 3.634322516163024*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixTranspose", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634322518028305*^9, 3.634322521764483*^9}, {
  3.634322809687311*^9, 3.634322861568741*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634322844433599*^9, 3.6343228507821407`*^9}, {
  3.636379106900836*^9, 3.636379115732786*^9}}]
}, Open  ]],

Cell["Check the answer", "Text",
 CellChangeTimes->{{3.634322872341199*^9, 3.63432287754084*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[Transpose]"}], 
    "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "-", 
   RowBox[{"MatrixTranspose", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
      RowBox[{"Array", "[", 
       RowBox[{"b", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634322883954399*^9, 3.63432289881446*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634322888684841*^9, 3.634322899155798*^9}, {
  3.636379106939472*^9, 3.6363791158156023`*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Swap", "Subsection",
 CellChangeTimes->{{3.6343112271179*^9, 3.634311227623914*^9}}],

Cell[TextData[{
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the result of permuting the matrix or vector ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["on ",
  FontWeight->"Plain"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" subsystems ",
  FontWeight->"Plain"],
 "according to the ordering specified by ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " ,",
 StyleBox[" where subsystem ",
  FontWeight->"Plain"],
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" has dimension ",
  FontWeight->"Plain"],
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the result of permuting the matrix or vector ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["on ",
  FontWeight->"Plain"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" subsystems ",
  FontWeight->"Plain"],
 "according to the ordering specified by ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " ,",
 StyleBox[" where each subsystem has dimension ",
  FontWeight->"Plain"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".\n\n",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 StyleBox[" returns ",
  FontWeight->"Plain"],
 StyleBox["Swap[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311231947031*^9, {3.634318615466152*^9, 3.634318617121394*^9}, {
   3.6343230569066133`*^9, 3.634323319178636*^9}},
 CellTags->"Swap::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343229151027927`*^9, 3.634322916006151*^9}, {
  3.634323031466917*^9, 3.634323035378474*^9}}],

Cell["Swap two subsystems", "Text",
 CellChangeTimes->{{3.634322920965261*^9, 3.634322924678784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Swap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634322927767591*^9, 3.634322993754284*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"1", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "1"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "2"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"b", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634322945911104*^9, 3.634322994115757*^9}, {
  3.636379107064888*^9, 3.636379115871667*^9}}]
}, Open  ]],

Cell["Check Solution is correct", "Text",
 CellChangeTimes->{{3.6343229973615923`*^9, 3.6343230230181627`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"b", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "-", 
  RowBox[{"Swap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "\[CircleTimes]", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634323009590301*^9, 3.6343230170098467`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.634323017197439*^9, {3.6363791071068993`*^9, 3.636379115945751*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Reshuffle", "Subsection",
 CellChangeTimes->{{3.6343112381666803`*^9, 3.634311239875751*^9}}],

Cell[TextData[{
 StyleBox["Column Reshuffling",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 StyleBox["\nReshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["dl1,dl2,dr1,dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}] ", "Input"],
 "returns the column reshuffling of the bipartite matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with dimensions ",
 StyleBox["{", "Input"],
 StyleBox["dl1*dl2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["r1*dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ". This operation corresponds to ",
 StyleBox["MatrixTranspose", "Input"],
 " operation with ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["={", "Input"],
 StyleBox["4,2,3,1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ".\n\n",
 StyleBox["Reshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] r", "Input"],
 "eturns the column reshuffling of the bipartite square matrix ",
 StyleBox["mat ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where both subsystems have the same dimension.",
  FontWeight->"Plain"],
 "\n\n",
 StyleBox["Row Reshuffling",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n",
 StyleBox["Reshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["dl1,dl2,dr1,dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},Basis\[Rule]\[CloseCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]] \
", "Input"],
 "returns the row reshuffling of the bipartite matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with dimensions ",
 StyleBox["{", "Input"],
 StyleBox["dl1*dl2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["r1*dr2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ". This operation corresponds to ",
 StyleBox["MatrixTranspose", "Input"],
 " operation with ",
 StyleBox["perm", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["={", "Input"],
 StyleBox["1,3,2,4", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ".\n\n",
 StyleBox["Reshuffle[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",Basis\[Rule]\[CloseCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]] \
", "Input"],
 "returns the row reshuffling of the bipartite square matrix ",
 StyleBox["mat ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["where both subsystems have the same dimension.",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311242646834*^9, {3.634318620402426*^9, 3.6343186205213213`*^9}, {
   3.634323369809149*^9, 3.634323494777597*^9}, {3.634323551536936*^9, 
   3.6343237145154457`*^9}, {3.63432393204455*^9, 3.634323972956599*^9}},
 CellTags->"Reshuffle::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634323733450584*^9, 3.634323734043366*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Basis", "\"\<Col\>\"", 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "type", " ", "of", " ", "reshuffling", " ",
       "operation", " ", "corresponding", " ", "to", " ", "the", " ", 
      "vectorization", " ", 
      RowBox[{"basis", ".", " ", "Allowed"}], " ", "values", " ", "are", " ", 
      "\!\(\*\"\\\"\"\)\!\(\*\"Col\"\)\!\(\*\"\\\"\"\)", " ", "or", " ", 
      RowBox[{"\!\(\*\"\\\"\"\)\!\(\*\"Row\"\)\!\(\*\"\\\"\"\)", "."}]}], 
     "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634323847805462*^9, 3.63432389828652*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343239780061893`*^9, 3.634323978957386*^9}}],

Cell["\<\
Showing that Reshuffling can be expressed as MatrixTranspose:\
\>", "Text",
 CellChangeTimes->{{3.6343240737899513`*^9, 3.634324083309002*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reshuffle", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "-", 
  RowBox[{"MatrixTranspose", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "2", ",", "3", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634323497922716*^9, 3.634323537757737*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343235125663652`*^9, 3.6343235382258053`*^9}, 
   3.634324565590424*^9, {3.636379107144986*^9, 3.636379116152508*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reshuffle", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Row\>\""}]}], "]"}], "-", 
  RowBox[{"MatrixTranspose", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634323497922716*^9, 3.634323537757737*^9}, {
  3.634324088784284*^9, 3.634324098326942*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634324098774249*^9, 3.634324162825457*^9, {3.634324539834733*^9, 
   3.634324561120493*^9}, {3.636379107178741*^9, 3.636379116184278*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Unravel", "Subsection",
 CellChangeTimes->{{3.634311250315641*^9, 3.634311251058013*^9}}],

Cell[TextData[{
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,..,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a vector or matrix on ",
 StyleBox["2n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " subsystems where two subsystems have dimension ",
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " for each ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". It transforms an operator ",
 StyleBox["a1\[CircleTimes]....\[CircleTimes]an\[CircleTimes]b1\[CircleTimes].\
..\[CircleTimes]bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into an operator ",
 StyleBox["a1\[CircleTimes]b1\[CircleTimes]...\[CircleTimes]an\[CircleTimes]\
bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where all subsystems are assumed to have dimension ",
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " assums ",
 StyleBox["d=2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" and returns ",
  FontWeight->"Plain"],
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",2]", "Input"],
 StyleBox[".\n\n",
  FontWeight->"Plain"],
 StyleBox["Unravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims,", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Unravel\[Rule]False]", "Input"],
 " returns the reravelling operation ",
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ". See ",
 StyleBox["Reravel", "Input"],
 " for further details."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311252963114*^9, {3.6343186231227503`*^9, 3.634318624780232*^9}, {
   3.634324588013916*^9, 3.634324864864793*^9}, {3.634324903896451*^9, 
   3.634325063785513*^9}, {3.634325104199978*^9, 3.63432510896889*^9}},
 CellTags->"Unravel::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634325136625819*^9, 3.634325137289431*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Unravel", "True", 
    RowBox[{
     StyleBox[
      RowBox[{
      "Specifies", " ", "if", " ", "an", " ", "Unravel", " ", "or", " ", 
       "Reravel", " ", "operation", " ", "should", " ", "be", " ", 
       "performed", ".", " ", "Unravel"}], "Text"], 
     StyleBox["\[Rule]", "Text"], 
     RowBox[{"False", " ", "implements", " ", "the", " ", "Reravel", " ", 
      RowBox[{"operation", "."}]}]}]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634325155121621*^9, 3.6343251805160007`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634325188339939*^9, 3.634325189107485*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Unravel", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "2"}], "]"}], "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", "2"}], "]"}], "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"c", ",", "2"}], "]"}], "\[CircleTimes]", 
    RowBox[{"Array", "[", 
     RowBox[{"d", ",", "2"}], "]"}]}], "]"}], "-", 
  RowBox[{
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", "2"}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"c", ",", "2"}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"b", ",", "2"}], "]"}], "\[CircleTimes]", 
   RowBox[{"Array", "[", 
    RowBox[{"d", ",", "2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.634325192483304*^9, 3.634325253981756*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.634325216809389*^9, 3.634325223610045*^9}, 
   3.634325254327937*^9, {3.636379107223845*^9, 3.6363791162181187`*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Reravel", "Subsection",
 CellChangeTimes->{{3.634311255040511*^9, 3.634311257357457*^9}}],

Cell[TextData[{
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{", "Input"],
 StyleBox["d1,..,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a vector or matrix on ",
 StyleBox["2n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " subsystems where two subsystems have dimension ",
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " for each ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". It transforms an operator ",
 StyleBox["a1\[CircleTimes]b1\[CircleTimes]...\[CircleTimes]an\[CircleTimes]\
bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " into an operator ",
 StyleBox["a1\[CircleTimes]....\[CircleTimes]an\[CircleTimes]b1\[CircleTimes].\
..\[CircleTimes]bn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "\n\n",
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " applies the unravelling operation ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " where all subsystems are assumed to have dimension ",
 StyleBox["d", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " assums ",
 StyleBox["d=2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" and returns ",
  FontWeight->"Plain"],
 StyleBox["Reravel[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",2]", "Input"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311262322356*^9, {3.634318626226563*^9, 3.63431862760165*^9}, {
   3.634324985130026*^9, 3.634324989572419*^9}, {3.634325084393806*^9, 
   3.634325130160615*^9}},
 CellTags->"Reravel::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343296761149397`*^9, 3.63432967687464*^9}}],

Cell["Unravel and Reravel are inverse operations", "Text",
 CellChangeTimes->{{3.634325282085545*^9, 3.634325289503196*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reravel", "[", 
   RowBox[{"Unravel", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "16"}], "]"}], "]"}], "]"}], "-", 
  RowBox[{"Array", "[", 
   RowBox[{"a", ",", "16"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634325278842004*^9, 3.634325308672112*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.634325294995228*^9, 3.634325308928164*^9}, {
  3.636379107257916*^9, 3.636379116264496*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix-Tensor Contractions", "Section",
 CellChangeTimes->{{3.634310848811734*^9, 3.634310852772456*^9}}],

Cell[CellGroupData[{

Cell["PartialTr", "Subsection",
 CellChangeTimes->{{3.634311147006694*^9, 3.6343111484129133`*^9}}],

Cell[TextData[{
 StyleBox["PartialTr[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", {", "Input"],
 StyleBox["d1,d2,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the matrix resulting from the partial trace over subsystems ",
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of the multipartite square matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ", where subsystem ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " has dimensions ",
 StyleBox["dj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["PartialTr[", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", {", "Input"],
 StyleBox["d1,d2,...,dn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the matrix resulting from the partial trace over subsystems ",
 StyleBox["i1,..,ik", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of the multipartite square matrix ",
 StyleBox["mat=", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Projector[", "Input"],
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " formed by the projector of the input vector or column vector ",
 StyleBox["vec", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".",
  FontWeight->"Plain",
  FontSlant->"Italic"]
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.6343111552573557`*^9, {3.63431863318824*^9, 3.634318634738823*^9}, {
   3.6343264445896177`*^9, 3.634326497416423*^9}, {3.634327259539918*^9, 
   3.6343273389977417`*^9}},
 CellTags->"PartialTr::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343269364043503`*^9, 3.6343269386197968`*^9}}],

Cell["\<\
Partial Trace of a of middle subsystem of a tripartite matrix.\
\>", "Text",
 CellChangeTimes->{{3.63432694072626*^9, 3.634326945811885*^9}, {
  3.634327231666716*^9, 3.634327242194942*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PartialTr", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "8"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634327097804036*^9, 3.6343271170751762`*^9}, {
  3.6343272452907677`*^9, 3.634327247948001*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "8"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "8"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"5", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"7", ",", "8"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "3"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "2"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "4"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "5"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "7"}], "]"}]}], 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"6", ",", "6"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"8", ",", "8"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.63432711083384*^9, 3.6343271173308487`*^9}, 
   3.63432724830811*^9, {3.636379107295844*^9, 3.6363791162992783`*^9}}]
}, Open  ]],

Cell["Partial trace over half of a maximally entangled Bell-state:", "Text",
 CellChangeTimes->{{3.6343272072641687`*^9, 3.634327219496735*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PartialTr", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634327123495984*^9, 3.634327157641445*^9}, {
  3.634327193873852*^9, 3.634327205902581*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "2"], "0"},
     {"0", 
      FractionBox["1", "2"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634327131385153*^9, 3.634327158035264*^9}, {
  3.6343271921295643`*^9, 3.634327221602024*^9}, {3.6363791073254023`*^9, 
  3.636379116335232*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorPairContract", "Subsection",
 CellChangeTimes->{{3.634311158065545*^9, 3.634311160854965*^9}}],

Cell[TextData[{
 StyleBox["TensorPairContract[", "Input"],
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}]", "Input"],
 " returns the tensor resulting from contracting index ",
 StyleBox["sj1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with index ",
 StyleBox["sj2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\nIf the contract list is the empty list ",
 StyleBox["{}", "Input"],
 " it returs ",
 StyleBox["TensorProduct[", "Input"],
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311165270151*^9, {3.634318635969058*^9, 3.634318638809119*^9}, {
   3.634326522592536*^9, 3.6343266101327047`*^9}},
 CellTags->"TensorPairContract::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634327350303303*^9, 3.6343273512006598`*^9}}],

Cell["Demonstrating matrix multiplication as a tensor contraction:", "Text",
 CellChangeTimes->{{3.63432735790985*^9, 3.6343274146759*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorPairContract", "[", 
     RowBox[{
      RowBox[{"Array", "[", 
       RowBox[{"a", ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ",", 
      RowBox[{"Array", "[", 
       RowBox[{"b", ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "10"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}], "-", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "10"}], "}"}]}], "]"}]}]}], "//", "Simplify"}], "//",
   "Norm"}]], "Input",
 CellChangeTimes->{{3.6343277801821527`*^9, 3.634327788881344*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.634327789276411*^9, {3.636379107360175*^9, 3.636379116382674*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MatrixContract", "Subsection",
 CellChangeTimes->{{3.634311167256405*^9, 3.6343111691462803`*^9}}],

Cell[TextData[{
 StyleBox["MatrixContract[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}]", "Input"],
 " returns the contraction of mat in the pairs ",
 StyleBox["{", "Input"],
 StyleBox["sj1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["sj2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " of slots by reshaping ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to a tensor using ",
 StyleBox["tens", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["=MatrixToTensor[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dims", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ", and then contracting according to ",
 StyleBox["TensorContract[tens,{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}]", "Input"],
 " and flattening the result back to a matrix.\n\nSee ",
 StyleBox["MatrixToTensor", "Input"],
 " and ",
 StyleBox["TensorContract", "Input"],
 " for more details."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311173190103*^9, {3.634318640217225*^9, 3.634318641874872*^9}, {
   3.634326619676176*^9, 3.634326753159697*^9}},
 CellTags->"MatrixContract::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.6343278045463457`*^9, 3.634327805345736*^9}}],

Cell["\<\
Contract the two right hand side indices of a matrix to return a vector:\
\>", "Text",
 CellChangeTimes->{{3.634327812775181*^9, 3.634327844151554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixContract", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634327845641173*^9, 3.634327870645131*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"1", ",", "4"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"2", ",", "4"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "1"}], "]"}], "+", 
       RowBox[{"a", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634327865453793*^9, 3.634327871049242*^9}, {
  3.636379107386347*^9, 3.636379116425722*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["MatrixPairContract", "Subsection",
 CellChangeTimes->{{3.6343111798567142`*^9, 3.63431118236517*^9}}],

Cell[TextData[{
 StyleBox["MatrixPairContract[{", "Input"],
 StyleBox["mat1,dims1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["mat2,dims2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{{", "Input"],
 StyleBox["s11,s12", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},{", "Input"],
 StyleBox["s21,s22", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["},...}] ", "Input"],
 "returns the matrix resulting from contracting index ",
 StyleBox["sj1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " with index ",
 StyleBox["sj2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " of tensor ",
 StyleBox["t2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " as per ",
 StyleBox["TensorPairContract ", "Input"],
 "where ",
 StyleBox["tj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["= MatrixToTensor[", "Input"],
 StyleBox["matj,dimsj", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ". If the contract list is the empty list ",
 StyleBox["{}", "Input"],
 " it yields ",
 StyleBox["CircleTimes[", "Input"],
 StyleBox["mat1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["mat2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 ".\n\nSee ",
 StyleBox["MatrixToTensor", "Input"],
 " and ",
 StyleBox["TensorPairContract", "Input"],
 " for more details."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634311185833832*^9, 3.6343111891488733`*^9}, {
  3.6343186440175037`*^9, 3.634318645753498*^9}, {3.6343267747352457`*^9, 
  3.634326906026476*^9}},
 CellTags->"MatrixPairContract::usage"],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.63432787670648*^9, 3.6343278773698483`*^9}}],

Cell["Demonstrating matrix multiplication as a tensor contraction:", "Text",
 CellChangeTimes->{{3.63432735790985*^9, 3.6343274146759*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "10"}], "}"}]}], "]"}]}], "-", 
    "\[IndentingNewLine]", 
    RowBox[{"MatrixPairContract", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"a", ",", 
          RowBox[{"{", 
           RowBox[{"10", ",", "20"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "20"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"b", ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "10"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"20", ",", "10"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}]}], "//", "Simplify"}], 
  "//", "Norm"}]], "Input",
 CellChangeTimes->{{3.6343277801821527`*^9, 3.634327788881344*^9}, {
  3.634327919005637*^9, 3.6343279651308107`*^9}, {3.634328211330098*^9, 
  3.634328213169648*^9}, {3.634328422777266*^9, 3.634328430463314*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.634327789276411*^9, {3.634327947669262*^9, 3.634327974758628*^9}, {
   3.634328380981284*^9, 3.6343284308053207`*^9}, {3.636379107420085*^9, 
   3.63637911646717*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Operator Bases", "Section",
 CellChangeTimes->{{3.634310858014436*^9, 3.6343108658449507`*^9}}],

Cell[CellGroupData[{

Cell["Basis", "Subsection",
 CellChangeTimes->{{3.634311102400095*^9, 3.634311102860838*^9}}],

Cell[TextData[{
 StyleBox["Basis[", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the multipartite matrix basis for a multipartite system with ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " identicle subsystems in terms of the subsystem basis ",
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", which ",
  FontWeight->"Plain"],
 "may either be a list of vectors or matrices ",
 StyleBox["{", "Input"],
 StyleBox["b1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["bk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " or a string for named bases.\nSupported named bases are:\n\[Bullet]  ",
 StyleBox["\[CloseCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " for the normalized Pauli basis ",
 StyleBox["PauliMatrix[", "Input"],
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]/Sqrt[2]", "Input"],
 " with ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["=0,1,2,3", "Input"],
 ".\n\[Bullet]  ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 " for the product operator basis (unnormalized Pauli basis) ",
 StyleBox["PauliMatrix[", "Input"],
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " with ",
 StyleBox["j", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["=0,1,2,3", "Input"],
 ".\n\[Bullet]  ",
 StyleBox["\[OpenCurlyDoubleQuote]Weyl\[CloseCurlyDoubleQuote][d]", "Input"],
 " for the dimension ",
 StyleBox["d", "Input"],
 " normalized Weyl basis\n\n",
 StyleBox["Basis[", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns ",
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " if it is a list of operators, and returns the corresponding basis of \
operators if it is a named basis string. "
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.6343111181549892`*^9, 3.634311128056398*^9}, {
  3.6343186498517714`*^9, 3.634318651337723*^9}, {3.6343285183123293`*^9, 
  3.634328761875929*^9}, {3.634328914570189*^9, 3.634328956619102*^9}, {
  3.6582422708977833`*^9, 3.658242298264565*^9}, {3.65824415296458*^9, 
  3.658244154307097*^9}},
 CellTags->"Basis::usage"],

Cell[CellGroupData[{

Cell["Example 1: Pauli and PO Bases", "Subsubsection",
 CellChangeTimes->{{3.634328898352957*^9, 3.6343288990010233`*^9}, {
  3.634329065997589*^9, 3.6343290661115417`*^9}, {3.658242544197647*^9, 
  3.658242565212183*^9}}],

Cell["Pauli Basis for a single system", "Text",
 CellChangeTimes->{{3.634328986724061*^9, 3.6343289911799097`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", "\"\<Pauli\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.6343289016486063`*^9, 3.634328905113599*^9}, {
  3.634328963110499*^9, 3.634328993036989*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", 
         SqrtBox["2"]]},
       {
        FractionBox["1", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", 
         FractionBox["\[ImaginaryI]", 
          SqrtBox["2"]]}]},
       {
        FractionBox["\[ImaginaryI]", 
         SqrtBox["2"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["2"]], "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox["1", 
          SqrtBox["2"]]}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634328907094754*^9, {3.634328965051325*^9, 3.63432899345542*^9}, {
   3.63637910744383*^9, 3.6363791164987097`*^9}, 3.658242073257518*^9, {
   3.6582421328832083`*^9, 3.658242145473794*^9}, 3.658242205262801*^9}]
}, Open  ]],

Cell["Product Operator basis for 2 subsystems:", "Text",
 CellChangeTimes->{{3.634328995620619*^9, 3.634329002380846*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", 
   RowBox[{"\"\<PO\>\"", ",", "2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6343289698366127`*^9, 3.6343289700280657`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"},
       {"0", "0", "0", "1"},
       {"0", "0", "1", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", "\[ImaginaryI]", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "0", "1", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"},
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "1"},
       {"0", "0", "1", "0"},
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", "\[ImaginaryI]", "0"},
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]},
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", "\[ImaginaryI]", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "\[ImaginaryI]", "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", 
        RowBox[{"-", "1"}]},
       {"0", "0", "1", "0"},
       {"0", "1", "0", "0"},
       {
        RowBox[{"-", "1"}], "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"},
       {"0", "0", "0", "\[ImaginaryI]"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {"1", "0", "0", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0"},
       {"\[ImaginaryI]", "0", "0", "0"},
       {"0", "0", "0", "\[ImaginaryI]"},
       {"0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {"0", "0", 
        RowBox[{"-", "1"}], "0"},
       {"0", "0", "0", "1"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.63432897034231*^9, {3.6363791074763613`*^9, 3.6363791165301437`*^9}, 
   3.658242074717579*^9, {3.658242133973484*^9, 3.658242146432632*^9}, 
   3.658242206355289*^9}]
}, Open  ]],

Cell["Weyl basis for dimension 3 single system", "Text",
 CellChangeTimes->{{3.6582422376956577`*^9, 3.658242260407208*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2: Weyl Basis", "Subsubsection",
 CellChangeTimes->{{3.6582423281749163`*^9, 3.6582423296312304`*^9}, {
  3.658242550427257*^9, 3.6582425803732147`*^9}}],

Cell[TextData[{
 "The Weyl basis can be constructed by taking ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "a"], 
    RowBox[{
     SuperscriptBox["V", "b"], "/", 
     SqrtBox["d"]}]}], TraditionalForm]]],
 " for all powers a=0,..,d-1 and b=0,..,d-1 where ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]]],
 " are defined as:"
}], "Text",
 CellChangeTimes->{{3.658242347486588*^9, 3.658242387831071*^9}, {
   3.658242449302395*^9, 3.658242467485632*^9}, 3.658242858259571*^9, {
   3.6582441239644117`*^9, 3.658244130978009*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WeylGenU", "[", "d_", "]"}], ":=", 
  RowBox[{"RotateLeft", "[", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "d", "]"}], ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeylGenV", "[", "d_", "]"}], ":=", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"2", "\[Pi]", "*", "I", "*", 
       RowBox[{"n", "/", "d"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.658242399623907*^9, 3.658242445612968*^9}}],

Cell["We can use the \[OpenCurlyDoubleQuote]Weyl\[CloseCurlyDoubleQuote]  \
named basis to get these: ", "Text",
 CellChangeTimes->{{3.658242476341989*^9, 3.658242496982479*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", 
   RowBox[{
    RowBox[{"\"\<Weyl\>\"", "[", "3", "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6582414258146267`*^9, 3.65824143966502*^9}, 
   3.658242228913412*^9, 3.65824226304867*^9, 3.658242814999002*^9, 
   3.6582428667340384`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["3"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]], 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]}]], 
         SqrtBox["3"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]}]], 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]], 
         SqrtBox["3"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox["1", 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["3"]]},
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]], 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]}]], 
         SqrtBox["3"]]},
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]}]], 
         SqrtBox["3"]], "0"},
       {"0", "0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]], 
         SqrtBox["3"]]},
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox["1", 
         SqrtBox["3"]]},
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox["1", 
         SqrtBox["3"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]}]], 
         SqrtBox["3"]]},
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]], 
         SqrtBox["3"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]], 
         SqrtBox["3"]]},
       {
        FractionBox["1", 
         SqrtBox["3"]], "0", "0"},
       {"0", 
        FractionBox[
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Pi]"}], "3"]}]], 
         SqrtBox["3"]], "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.658241439977421*^9, 3.658242084883539*^9, {3.658242135366235*^9, 
   3.658242147798822*^9}, {3.658242207569419*^9, 3.65824222979673*^9}, 
   3.658242263252007*^9, 3.6582425095696707`*^9, 3.6582428152705097`*^9, 
   3.658242866893631*^9, 3.65824414096014*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 3: Custom Bases", "Subsubsection",
 CellChangeTimes->{{3.634329068181617*^9, 3.634329069014865*^9}, {
  3.658242324487392*^9, 3.6582423245822973`*^9}, {3.658242556941451*^9, 
  3.6582425765416327`*^9}}],

Cell["\<\
Basis also works for vector bases. Consider the Plus basis for a qubit:\
\>", "Text",
 CellChangeTimes->{{3.634329071397273*^9, 3.63432909448773*^9}, {
  3.634329147978854*^9, 3.6343291484738483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634329077679118*^9, 3.6343290862242937`*^9}, {
  3.634329116537286*^9, 3.634329159490135*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", 
          SqrtBox["2"]]},
        {
         FractionBox["1", 
          SqrtBox["2"]]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", 
          SqrtBox["2"]]},
        {
         RowBox[{"-", 
          FractionBox["1", 
           SqrtBox["2"]]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634329086819631*^9, {3.634329120231735*^9, 3.6343291598411093`*^9}, {
   3.636379107508222*^9, 3.6363791165516987`*^9}}]
}, Open  ]],

Cell["The plus basis for 2 qubits is given by", "Text",
 CellChangeTimes->{{3.634329097656314*^9, 3.634329103944086*^9}, {
  3.634329172169877*^9, 3.634329186489959*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Basis", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}], "/", 
       RowBox[{"Sqrt", "[", "2", "]"}]}]}], "}"}], ",", "2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.634329105513557*^9, 3.634329136051854*^9}, {
  3.6343291682163687`*^9, 3.634329188563127*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         FractionBox["1", "2"]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         RowBox[{"-", 
          FractionBox["1", "2"]}]},
        {
         FractionBox["1", "2"]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.634329112049776*^9, 3.634329136339696*^9}, {
  3.634329175804925*^9, 3.634329188918448*^9}, {3.636379107541719*^9, 
  3.636379116581859*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["BasisLabels", "Subsection",
 CellChangeTimes->{{3.634311104007863*^9, 3.634311106675256*^9}}],

Cell[TextData[{
 StyleBox["BasisLabels[", "Input"],
 StyleBox["label", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the basis labels for the multipartite matrix basis of a \
multipartite system with ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " identicle subsystems, in terms of the subsystem basis label ",
 StyleBox["label", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", which m",
  FontWeight->"Plain"],
 "ay either be a list of strings ",
 StyleBox["{", "Input"],
 StyleBox["s1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",...,", "Input"],
 StyleBox["sk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " or a single string for named bases.\nSupported named bases are:\n\[Bullet] \
 ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " for the normalized Pauli basis.\n\[Bullet]  ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 " for the product operator basis (unnormalized Pauli basis).\n\[Bullet]  ",
 StyleBox["\[OpenCurlyDoubleQuote]Weyl\[CloseCurlyDoubleQuote][d]", "Input"],
 " for the dimension ",
 StyleBox["d", "Input"],
 " normalized Weyl basis\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Join\[Rule]Automatic", "Input"],
 " specifies that the subsystem basis labels should be joined using ",
 StyleBox["CircleTimes", "Input"],
 ", ",
 StyleBox["s1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[CircleTimes]", "Input"],
 StyleBox["s2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". This is the default value.\n\[Bullet]",
 StyleBox[" Join\[Rule]True", "Input"],
 " specifies that the subsystem basis labels should be joined using ",
 StyleBox["StringJoin", "Input"],
 ", ",
 StyleBox["s1s2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". \n\[Bullet]",
 StyleBox[" Join\[Rule]False", "Input"],
 " specifies that the subsystem basis labels should not be joined and instead \
returned as a list ",
 StyleBox["{", "Input"],
 StyleBox["s1,s2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ". \n\[Bullet]",
 StyleBox[" Join\[Rule]", "Input"],
 StyleBox["f", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies that the subsystem basis label strings should be joined using ",
 StyleBox["f", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ", ",
 StyleBox["f", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["[", "Input"],
 StyleBox["s1,s2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311123104019*^9, {3.6343186537641172`*^9, 3.634318655298319*^9}, {
   3.634328796250102*^9, 3.6343288898478327`*^9}, {3.638287344838895*^9, 
   3.638287593283258*^9}, {3.638288457970565*^9, 3.6382884977811737`*^9}, {
   3.658242537791894*^9, 3.658242540695698*^9}, {3.658244166973588*^9, 
   3.658244168173009*^9}},
 CellTags->"BasisLabels::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.638288304664606*^9, 3.638288305205031*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Join", "Automatic", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Specifies", " ", "the", " ", "function", " ", "used", " ", "to", " ", 
       "combine", " ", "subsystem", " ", "basis", " ", 
       RowBox[{"labels", ".", " ", "Can"}], " ", "be", " ", "Automatic"}], 
      ",", " ", "True", ",", " ", "False", ",", " ", 
      RowBox[{"or", " ", "a", " ", 
       RowBox[{"function", "."}]}]}], "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.638288317488408*^9, 3.6382883256761627`*^9}, {
  3.638288506885209*^9, 3.6382885123059196`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 1: PO Basis", "Subsubsection",
 CellChangeTimes->{{3.634329011588978*^9, 3.634329012260766*^9}, {
  3.6382878562848577`*^9, 3.638287859232588*^9}}],

Cell["Product operator basis for two qubits:", "Text",
 CellChangeTimes->{{3.634329031948084*^9, 3.6343290378524027`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{"\"\<PO\>\"", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.6343290132772093`*^9, 3.634329029509178*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], ",", 
   RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Z\"\>"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343290172845573`*^9, 3.634329029951603*^9}, {
   3.636379107578493*^9, 3.6363791166182413`*^9}, 3.638287812662944*^9}]
}, Open  ]],

Cell["... using different options", "Text",
 CellChangeTimes->{{3.638287817776287*^9, 3.638287828384881*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{"\"\<PO\>\"", ",", "2", ",", 
   RowBox[{"Join", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.63828782966966*^9, 3.6382878396811666`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"II\"\>", ",", "\<\"IX\"\>", ",", "\<\"IY\"\>", 
   ",", "\<\"IZ\"\>", ",", "\<\"XI\"\>", ",", "\<\"XX\"\>", ",", "\<\"XY\"\>",
    ",", "\<\"XZ\"\>", ",", "\<\"YI\"\>", ",", "\<\"YX\"\>", 
   ",", "\<\"YY\"\>", ",", "\<\"YZ\"\>", ",", "\<\"ZI\"\>", ",", "\<\"ZX\"\>",
    ",", "\<\"ZY\"\>", ",", "\<\"ZZ\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.638287840078113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{"\"\<PO\>\"", ",", "2", ",", 
   RowBox[{"Join", "\[Rule]", "f"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6382878455918007`*^9, 3.638287846147979*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\<\"I\"\>", ",", "\<\"I\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"I\"\>", ",", "\<\"X\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"I\"\>", ",", "\<\"Y\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"I\"\>", ",", "\<\"Z\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"X\"\>", ",", "\<\"I\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"X\"\>", ",", "\<\"X\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"X\"\>", ",", "\<\"Y\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"X\"\>", ",", "\<\"Z\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Y\"\>", ",", "\<\"I\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Y\"\>", ",", "\<\"X\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Y\"\>", ",", "\<\"Y\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Y\"\>", ",", "\<\"Z\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Z\"\>", ",", "\<\"I\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Z\"\>", ",", "\<\"X\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Z\"\>", ",", "\<\"Y\"\>"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\<\"Z\"\>", ",", "\<\"Z\"\>"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.638287847087031*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2: Pauli Basis", "Subsubsection",
 CellChangeTimes->{{3.63828786382209*^9, 3.6382878668375483`*^9}}],

Cell[TextData[{
 "For the Pauli basis, the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "/", 
    SqrtBox["2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " factors are mutliplied:"
}], "Text",
 CellChangeTimes->{{3.638287867837574*^9, 3.638287885827606*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{"\"\<Pauli\>\"", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.6382878871952744`*^9, 3.6382879011493063`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"X\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"X\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], "2"], ",", 
   FractionBox[
    RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], "2"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.638287897940106*^9, 3.638287901359601*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{"\"\<Pauli\>\"", ",", "2", ",", 
   RowBox[{"Join", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.638287906076668*^9, 3.6382879083838797`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["\<\"II\"\>", "2"], ",", 
   FractionBox["\<\"IX\"\>", "2"], ",", 
   FractionBox["\<\"IY\"\>", "2"], ",", 
   FractionBox["\<\"IZ\"\>", "2"], ",", 
   FractionBox["\<\"XI\"\>", "2"], ",", 
   FractionBox["\<\"XX\"\>", "2"], ",", 
   FractionBox["\<\"XY\"\>", "2"], ",", 
   FractionBox["\<\"XZ\"\>", "2"], ",", 
   FractionBox["\<\"YI\"\>", "2"], ",", 
   FractionBox["\<\"YX\"\>", "2"], ",", 
   FractionBox["\<\"YY\"\>", "2"], ",", 
   FractionBox["\<\"YZ\"\>", "2"], ",", 
   FractionBox["\<\"ZI\"\>", "2"], ",", 
   FractionBox["\<\"ZX\"\>", "2"], ",", 
   FractionBox["\<\"ZY\"\>", "2"], ",", 
   FractionBox["\<\"ZZ\"\>", "2"]}], "}"}]], "Output",
 CellChangeTimes->{3.638287908756248*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 3: Weyl Basis", "Subsubsection",
 CellChangeTimes->{{3.658242596438241*^9, 3.658242602795362*^9}}],

Cell[TextData[{
 "The Weyl basis are indexed as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "[", 
    RowBox[{"a", ",", "b"}], "]"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " where ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox["b", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are the powers in the expression ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["U", "a"], 
    RowBox[{
     SuperscriptBox["V", "b"], "."}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " See Example 2 in the Basis section for details."
}], "Text",
 CellChangeTimes->{{3.6582426369730253`*^9, 3.658242725236545*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{
   RowBox[{"\"\<Weyl\>\"", "[", "2", "]"}], ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.65824261892292*^9, 3.6582426225626917`*^9}, 
   3.658242687524509*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"W[0,0]\"\>", "\[CircleTimes]", "\<\"W[0,0]\"\>"}], ",", 
   RowBox[{"\<\"W[0,0]\"\>", "\[CircleTimes]", "\<\"W[0,1]\"\>"}], ",", 
   RowBox[{"\<\"W[0,0]\"\>", "\[CircleTimes]", "\<\"W[1,0]\"\>"}], ",", 
   RowBox[{"\<\"W[0,0]\"\>", "\[CircleTimes]", "\<\"W[1,1]\"\>"}], ",", 
   RowBox[{"\<\"W[0,1]\"\>", "\[CircleTimes]", "\<\"W[0,0]\"\>"}], ",", 
   RowBox[{"\<\"W[0,1]\"\>", "\[CircleTimes]", "\<\"W[0,1]\"\>"}], ",", 
   RowBox[{"\<\"W[0,1]\"\>", "\[CircleTimes]", "\<\"W[1,0]\"\>"}], ",", 
   RowBox[{"\<\"W[0,1]\"\>", "\[CircleTimes]", "\<\"W[1,1]\"\>"}], ",", 
   RowBox[{"\<\"W[1,0]\"\>", "\[CircleTimes]", "\<\"W[0,0]\"\>"}], ",", 
   RowBox[{"\<\"W[1,0]\"\>", "\[CircleTimes]", "\<\"W[0,1]\"\>"}], ",", 
   RowBox[{"\<\"W[1,0]\"\>", "\[CircleTimes]", "\<\"W[1,0]\"\>"}], ",", 
   RowBox[{"\<\"W[1,0]\"\>", "\[CircleTimes]", "\<\"W[1,1]\"\>"}], ",", 
   RowBox[{"\<\"W[1,1]\"\>", "\[CircleTimes]", "\<\"W[0,0]\"\>"}], ",", 
   RowBox[{"\<\"W[1,1]\"\>", "\[CircleTimes]", "\<\"W[0,1]\"\>"}], ",", 
   RowBox[{"\<\"W[1,1]\"\>", "\[CircleTimes]", "\<\"W[1,0]\"\>"}], ",", 
   RowBox[{"\<\"W[1,1]\"\>", "\[CircleTimes]", "\<\"W[1,1]\"\>"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6582426228807907`*^9, 3.658242687777843*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 4: Custom Bases", "Subsubsection",
 CellChangeTimes->{{3.638287912703402*^9, 3.6382879173278513`*^9}, 
   3.658242606509016*^9}],

Cell["To use custom bases labels we can input them as a list", "Text",
 CellChangeTimes->{{3.63828791920453*^9, 3.638287927677657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<a1\>\"", ",", "\"\<a2\>\"", ",", "\"\<a3\>\""}], "}"}], ",", 
   "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.638287929152212*^9, 3.638287944823433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"a1\"\>", "\[CircleTimes]", "\<\"a1\"\>"}], ",", 
   RowBox[{"\<\"a1\"\>", "\[CircleTimes]", "\<\"a2\"\>"}], ",", 
   RowBox[{"\<\"a1\"\>", "\[CircleTimes]", "\<\"a3\"\>"}], ",", 
   RowBox[{"\<\"a2\"\>", "\[CircleTimes]", "\<\"a1\"\>"}], ",", 
   RowBox[{"\<\"a2\"\>", "\[CircleTimes]", "\<\"a2\"\>"}], ",", 
   RowBox[{"\<\"a2\"\>", "\[CircleTimes]", "\<\"a3\"\>"}], ",", 
   RowBox[{"\<\"a3\"\>", "\[CircleTimes]", "\<\"a1\"\>"}], ",", 
   RowBox[{"\<\"a3\"\>", "\[CircleTimes]", "\<\"a2\"\>"}], ",", 
   RowBox[{"\<\"a3\"\>", "\[CircleTimes]", "\<\"a3\"\>"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.638287941869945*^9, 3.638287945022957*^9}}]
}, Open  ]],

Cell["These need not be strings", "Text",
 CellChangeTimes->{{3.638287956162051*^9, 3.6382879584575357`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.638287958981432*^9, 3.638287969729455*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}], "\[CircleTimes]", 
    RowBox[{"a", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.638287964808855*^9, 3.638287970161606*^9}}]
}, Open  ]],

Cell["\<\
... though in this case using Join->True will return an error\
\>", "Text",
 CellChangeTimes->{{3.638287973430744*^9, 3.6382879810813637`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", "2", ",", 
   RowBox[{"Join", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.638287984609096*^9, 3.6382880352628613`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"StringJoin", "::", "string"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"String expected at position \[NoBreak]\\!\\(1\\)\[NoBreak] \
in \[NoBreak]\\!\\(\\(\\(a[1]\\)\\) <> \\(\\(a[1]\\)\\)\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/StringJoin\\\", ButtonNote -> \
\\\"StringJoin::string\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6382880356384897`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"StringJoin", "::", "string"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"String expected at position \[NoBreak]\\!\\(2\\)\[NoBreak] \
in \[NoBreak]\\!\\(\\(\\(a[1]\\)\\) <> \\(\\(a[1]\\)\\)\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/StringJoin\\\", ButtonNote -> \
\\\"StringJoin::string\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6382880357026787`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"StringJoin", "::", "string"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"String expected at position \[NoBreak]\\!\\(1\\)\[NoBreak] \
in \[NoBreak]\\!\\(\\(\\(a[1]\\)\\) <> \\(\\(a[2]\\)\\)\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/StringJoin\\\", ButtonNote -> \
\\\"StringJoin::string\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638288035767411*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(StringJoin :: string\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638288035793243*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "<>", 
    RowBox[{"a", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "<>", 
    RowBox[{"a", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "<>", 
    RowBox[{"a", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "<>", 
    RowBox[{"a", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6382879916738243`*^9, 3.638288035797847*^9}}]
}, Open  ]],

Cell["In this case we could use List as a custom joining function:", "Text",
 CellChangeTimes->{{3.638288061046142*^9, 3.638288077460392*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisLabels", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", "2", ",", 
   RowBox[{"Join", "\[Rule]", "List"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.638288043660482*^9, 3.638288053752658*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], ",", 
     RowBox[{"a", "[", "1", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.638288046266243*^9, 3.638288054037189*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ExpressInBasis", "Subsection",
 CellChangeTimes->{{3.634311108372843*^9, 3.63431111019592*^9}}],

Cell[TextData[{
 StyleBox["ExpressInBasis[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "expresses operator ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " in terms of basis elements for the basis specified in options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "specifies the basis to express ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " in. The default basis value is ",
 StyleBox["\[CloseCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 " (see ",
 StyleBox["Basis", "Input"],
 " for more details).\n\[Bullet]",
 StyleBox[" BasisLabels\[Rule]", "Input"],
 StyleBox["labels", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies whether to display the basis labels along side the basis element \
coefficients. The default value is ",
 StyleBox["False", "Input"],
 ". ",
 StyleBox["labels", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" may b",
  FontWeight->"Plain"],
 StyleBox["e",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" ",
  FontSlant->"Italic"],
 "a list of string labels, or the value ",
 StyleBox["True", "Input"],
 " to use the default labels for a named basis (see ",
 StyleBox["BasisLabels", "Input"],
 " for more details).\n\[Bullet]",
 StyleBox[" Join\[Rule]", "Input"],
 StyleBox["fn", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies how subsystem basis labels should be joined (see ",
 StyleBox["BasisLabels", "Input"],
 " for more details).\n\[Bullet]",
 StyleBox[" Chop\[Rule]True", "Input"],
 " specifies that zero value coefficients should be removed from the returned \
list. This default value is ",
 StyleBox["False", "Input"],
 ". This option only applies if the ",
 StyleBox["BasisLabels", "Input"],
 " option is not set to ",
 StyleBox["False", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311133927567*^9, {3.634318657915893*^9, 3.6343186594910316`*^9}, {
   3.634329217923348*^9, 3.634329487725719*^9}, {3.638287622938908*^9, 
   3.638287806605928*^9}, 3.63828822399264*^9},
 CellTags->"ExpressInBasis::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.6343115904944897`*^9, 3.634311591135709*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Basis", "\"\<PO\>\"", 
    StyleBox[
     RowBox[{
     "Specifies", " ", "the", " ", "basis", " ", "to", " ", "express", " ", 
      "an", " ", "operator", " ", "in", " ", "terms", " ", 
      RowBox[{"of", ".", " ", "It"}], " ", "may", " ", "be", " ", "a", " ", 
      "named", " ", "basis", " ", "string", " ", "or", " ", "a", " ", "list", 
      " ", "of", " ", "basis", " ", 
      RowBox[{"elements", "."}]}], "Text"]},
   {"BasisLabels", "False", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Specifies", " ", "whether", " ", "to", " ", "display", " ", "the", " ",
        "basis", " ", "labels", " ", "in", " ", "the", " ", 
       RowBox[{"decomposition", ".", " ", "It"}], " ", "may", " ", "be", " ", 
       "False"}], ",", " ", "True", ",", " ", 
      RowBox[{
      "or", " ", "a", " ", "list", " ", "of", " ", "basis", " ", "label", " ", 
       RowBox[{"strings", "."}]}]}], "Text"]},
   {"Join", "Automatic", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Specifies", " ", "the", " ", "function", " ", "used", " ", "to", " ", 
       "combine", " ", "subsystem", " ", "basis", " ", 
       RowBox[{"labels", ".", " ", "Can"}], " ", "be", " ", "Automatic"}], 
      ",", " ", "True", ",", " ", "False", ",", " ", 
      RowBox[{"or", " ", "a", " ", 
       RowBox[{"function", "."}]}]}], "Text"]},
   {"Chop", "False", 
    StyleBox[
     RowBox[{
     "Specifies", " ", "whether", " ", "to", " ", "remove", " ", "zero", " ", 
      "valued", " ", "results", " ", "when", " ", "BasisLabels", " ", "is", 
      " ", "set", " ", "to", " ", 
      RowBox[{"True", ".", " "}]}], "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.638288233618071*^9, 3.638288294653777*^9}, {
  3.638288518619467*^9, 3.638288524266572*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.634329046926429*^9, 3.6343290476219788`*^9}, {
  3.6382881081384983`*^9, 3.6382881082291317`*^9}}],

Cell["Express a bipartite matrix in the PO Basis", "Text",
 CellChangeTimes->{{3.634329574537704*^9, 3.634329583256496*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpressInBasis", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634329558139332*^9, 3.634329585986315*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "3"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"2", ",", "1"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"3", ",", "4"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"4", ",", "3"}], "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "4"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "1"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "2"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "4"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "2"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "1"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"1", ",", "4"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"4", ",", "1"}], "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "3"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "4"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "1"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "2"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"2", ",", "4"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"4", ",", "2"}], "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"1", ",", "4"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"4", ",", "1"}], "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"a", "[", 
            RowBox[{"1", ",", "4"}], "]"}]}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "3"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "2"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "1"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"2", ",", "4"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"4", ",", "2"}], "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "2"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "4"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "3"}], "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"1", ",", "2"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"2", ",", "1"}], "]"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"3", ",", "4"}], "]"}]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"a", "[", 
            RowBox[{"4", ",", "3"}], "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "2"}], "]"}], "-", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "3"}], "]"}], "+", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634329566204915*^9, 3.634329586188072*^9}, {
   3.636379107606083*^9, 3.636379116662875*^9}, 3.638288090253167*^9}]
}, Open  ]],

Cell["The same matrix with basis labels", "Text",
 CellChangeTimes->{{3.6343295926347733`*^9, 3.634329596259069*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpressInBasis", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"BasisLabels", "\[Rule]", "True"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6343295993081007`*^9, 3.634329604365075*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "4"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "3"}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{"\<\"I\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "4"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "4"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "2"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "1"}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{"\<\"X\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "3"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "4"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "1"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "2"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "4"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "1"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "2"}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "4"}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "3"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "2"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "1"}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "4"}], "]"}]}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "3"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "2"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "1"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"Y\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "4"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "1"}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "2"}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"I\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"X\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "4"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "3"}], "]"}]}], ")"}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Y\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"3", ",", "4"}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"a", "[", 
           RowBox[{"4", ",", "3"}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{"\<\"Z\"\>", "\[CircleTimes]", "\<\"Z\"\>"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "2"}], "]"}], "-", 
         RowBox[{"a", "[", 
          RowBox[{"3", ",", "3"}], "]"}], "+", 
         RowBox[{"a", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634329604901819*^9, {3.636379107637142*^9, 3.6363791166997957`*^9}, 
   3.638288093993058*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsubsection",
 CellChangeTimes->{{3.638288112502069*^9, 3.6382881170019407`*^9}}],

Cell["\<\
If we have a sparse matrix in a given basis, we can use the option Chop to \
remove non-zero entries\
\>", "Text",
 CellChangeTimes->{{3.638288120230653*^9, 3.638288130740115*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpressInBasis", "[", 
  RowBox[{
   RowBox[{"TP", "[", "XZY", "]"}], ",", 
   RowBox[{"BasisLabels", "\[Rule]", "True"}], ",", 
   RowBox[{"Chop", "\[Rule]", "True"}], ",", 
   RowBox[{"Join", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.638288133413588*^9, 3.638288188577643*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\<\"XZY\"\>", ",", "1"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.638288144706958*^9, 3.638288158343124*^9}, 
   3.638288188886334*^9}]
}, Open  ]],

Cell["If we don\[CloseCurlyQuote]t use labels the option Chop does nothing:", \
"Text",
 CellChangeTimes->{{3.638288168706942*^9, 3.638288175188847*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpressInBasis", "[", 
  RowBox[{
   RowBox[{"TP", "[", "XZY", "]"}], ",", 
   RowBox[{"Chop", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.638288182034451*^9, 3.638288183220367*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.638288183546525*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vectorization", "Section",
 CellChangeTimes->{{3.634310868499579*^9, 3.634310869782322*^9}}],

Cell[CellGroupData[{

Cell["Vec", "Subsection",
 CellChangeTimes->{{3.634310922061626*^9, 3.634310922387836*^9}, {
  3.634310955192596*^9, 3.6343109717760973`*^9}}],

Cell[TextData[{
 StyleBox["Vec[", "Input"],
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns a column vector formed by vectorizing a matrix ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " using the vectorization convention specified by the options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the vectorization basis convention to be used. It may be a \
string for named basies, or a list of basis operators. Allowed named bases \
are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " and ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ". The default value is ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " and corresponds to stacking the columns of ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " together to form a vector."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634311052959324*^9, 3.634311056263317*^9}, {
  3.634329793889833*^9, 3.634329971841034*^9}, {3.6343300917011843`*^9, 
  3.634330101373704*^9}},
 CellTags->"Vec::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634311058006653*^9, 3.634311058580744*^9}}],

Cell[BoxData[GridBox[{
   {
    StyleBox["Option", "Text",
     FontWeight->Bold], 
    StyleBox[
     RowBox[{"Default", " ", "Value"}], "Text",
     FontWeight->Bold], 
    StyleBox["Description", "Text",
     FontWeight->Bold]},
   {"Basis", "\"\<Col\>\"", 
    StyleBox[
     RowBox[{
      RowBox[{
      "Specifies", " ", "the", " ", "basis", " ", "to", " ", "be", " ", 
       "used", " ", "for", " ", 
       RowBox[{"vectorization", ".", " ", "Supposed"}], " ", "named", " ", 
       "bases", " ", "are", " ", 
       "\!\(\*\"\\\"\"\)\!\(\*\"Col\"\)\!\(\*\"\\\"\"\)"}], ",", " ", 
      "\!\(\*\"\\\"\"\)\!\(\*\"Row\"\)\!\(\*\"\\\"\"\)", ",", " ", 
      RowBox[{
      "\!\(\*\"\\\"\"\)\!\(\*\"Pauli\"\)\!\(\*\"\\\"\"\)", " ", "and", " ", 
       RowBox[{
       "\!\(\*\"\\\"\"\)\!\(\*\"PO\"\)\!\(\*\"\\\"\"\)", ".", " ", "May"}], 
       " ", "also", " ", "be", " ", "a", " ", "list", " ", "of", " ", "basis",
        " ", "operators", " ", "for", " ", "other", " ", 
       RowBox[{"bases", "."}]}]}], "Text"]}
  },
  GridBoxAlignment->{"Columns" -> {{Left}}},
  GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{True}}},
  GridBoxItemSize->{"Columns" -> {Automatic, Automatic, {
       Scaled[0.5]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
    "RowsIndexed" -> {}}]], "Text",
 CellChangeTimes->{{3.634329985002905*^9, 3.634330025008963*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634311059806551*^9, 3.6343110619107723`*^9}, {
  3.634342578347068*^9, 3.634342578508274*^9}}],

Cell["Vectorizing a matrix in the default col-stacking convention:", "Text",
 CellChangeTimes->{{3.634330185240637*^9, 3.634330197625986*^9}, 
   3.634342593571574*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vec", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330160899394*^9, 3.634330170452004*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "2"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343301676048203`*^9, 3.6343301708074427`*^9}, {
  3.6363791076739902`*^9, 3.636379116730813*^9}}]
}, Open  ]],

Cell["The same matrix vectorized in row-stacking convention:", "Text",
 CellChangeTimes->{{3.634342475320836*^9, 3.6343424899392853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Row\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634342494253759*^9, 3.6343424970770283`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "2"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "1"}], "]"}]},
     {
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "2"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634342497680213*^9, {3.6363791077070427`*^9, 3.636379116753437*^9}}]
}, Open  ]],

Cell["... and finally, vectorized in the Pauli Basis:", "Text",
 CellChangeTimes->{{3.634330173993432*^9, 3.6343302055530167`*^9}, {
  3.634342503322674*^9, 3.6343425191562347`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Vec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330177594534*^9, 3.634330180769084*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634330181117577*^9, {3.636379107736266*^9, 3.6363791167955437`*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Devec", "Subsection",
 CellChangeTimes->{{3.634310927945176*^9, 3.63431092862017*^9}, {
  3.634310959534721*^9, 3.6343109606146193`*^9}, {3.634311002194971*^9, 
  3.634311002284896*^9}}],

Cell[TextData[{
 StyleBox["Devec[", "Input"],
 StyleBox["vecMat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the matrix formed by de-vectorizing a vectorized matrix ",
 StyleBox["mecMat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " using the vectorization convention specified by the options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the vectorization basis convention to be used. It may be a \
string for named basies, or a list of basis operators. Allowed named bases \
are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " and ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ". The default value is ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " and corresponds to stacking the columns of ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " together to form a vector."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.634311041530568*^9, 3.6343110439895277`*^9}, {
  3.634330039973859*^9, 3.634330118598291*^9}},
 CellTags->"Devec::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634311058006653*^9, 3.634311058580744*^9}}],

Cell["The options are the same as for Vec.", "Text",
 CellChangeTimes->{{3.634330145936471*^9, 3.6343301567044983`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634311059806551*^9, 3.6343110619107723`*^9}, {
  3.634342575756796*^9, 3.634342576043347*^9}}],

Cell["\<\
De-vectorizing a vector in the default col-stacking convention:\
\>", "Text",
 CellChangeTimes->{{3.634330185240637*^9, 3.634330197625986*^9}, {
  3.634342583275296*^9, 3.634342590091613*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Devec", "[", 
   RowBox[{"Array", "[", 
    RowBox[{"a", ",", "4"}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330160899394*^9, 3.634330170452004*^9}, {
  3.6343425973820744`*^9, 3.634342601050905*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", "1", "]"}], 
      RowBox[{"a", "[", "3", "]"}]},
     {
      RowBox[{"a", "[", "2", "]"}], 
      RowBox[{"a", "[", "4", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343301676048203`*^9, 3.6343301708074427`*^9}, 
   3.634342601525776*^9, {3.636379107757812*^9, 3.6363791168340063`*^9}}]
}, Open  ]],

Cell["The same matrix vectorized in row-stacking convention:", "Text",
 CellChangeTimes->{{3.634342475320836*^9, 3.6343424899392853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Devec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "4"}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Row\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634342494253759*^9, 3.6343424970770283`*^9}, {
  3.634342606350422*^9, 3.6343426071251373`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"a", "[", "1", "]"}], 
      RowBox[{"a", "[", "2", "]"}]},
     {
      RowBox[{"a", "[", "3", "]"}], 
      RowBox[{"a", "[", "4", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634342497680213*^9, 3.634342607874937*^9, {3.6363791077961206`*^9, 
   3.636379116866363*^9}}]
}, Open  ]],

Cell["... and finally, vectorized in the Pauli Basis:", "Text",
 CellChangeTimes->{{3.634330173993432*^9, 3.6343302055530167`*^9}, {
  3.634342503322674*^9, 3.6343425191562347`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Devec", "[", 
   RowBox[{
    RowBox[{"Array", "[", 
     RowBox[{"a", ",", "4"}], "]"}], ",", 
    RowBox[{"Basis", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634330177594534*^9, 3.634330180769084*^9}, {
  3.634342611574954*^9, 3.634342614277372*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "1", "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"a", "[", "4", "]"}], 
        SqrtBox["2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "2", "]"}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", "3", "]"}]}], 
        SqrtBox["2"]]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "2", "]"}], 
        SqrtBox["2"]], "+", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"a", "[", "3", "]"}]}], 
        SqrtBox["2"]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"a", "[", "1", "]"}], 
        SqrtBox["2"]], "-", 
       FractionBox[
        RowBox[{"a", "[", "4", "]"}], 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.634330181117577*^9, 3.6343426147933693`*^9, {3.636379107840336*^9, 
   3.636379116888873*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ProductIdentity", "Subsection",
 CellChangeTimes->{{3.634310931285899*^9, 3.634310935696518*^9}, 
   3.63431100098005*^9}],

Cell[TextData[{
 StyleBox["ProductIdentity[", "Input"],
 StyleBox["A,C,opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns a matrix ",
 StyleBox["M", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " such that ",
 StyleBox["M", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[".Vec[", "Input"],
 StyleBox["B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]=Vec[", "Input"],
 StyleBox["A.B.C", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 "for matrices ",
 StyleBox["A,B", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " and ",
 StyleBox["C ", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "using the vectorization convention specified by the options ",
 StyleBox["opts", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ".\n\n",
 StyleBox["Options",
  FontWeight->"Bold",
  FontSlant->"Italic",
  FontColor->GrayLevel[0.5]],
 "\n\[Bullet]",
 StyleBox[" Basis\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " specifies the vectorization basis convention to be used. It may be a \
string for named basies, or a list of basis operators. Allowed named bases \
are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 " and ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ". The default value is ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " and corresponds to stacking the columns of ",
 StyleBox["mat", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " together to form a vector."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{{3.6343110346563396`*^9, 3.6343110456207457`*^9}, {
  3.6343426575341387`*^9, 3.634342658303225*^9}, {3.63434269073072*^9, 
  3.634342700869084*^9}},
 CellTags->"ProductIdentity::usage"],

Cell[CellGroupData[{

Cell["Options", "Subsubsection",
 CellChangeTimes->{{3.634311058006653*^9, 3.634311058580744*^9}}],

Cell["The options are the same as for Vec", "Text",
 CellChangeTimes->{3.634342715886712*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example", "Subsubsection",
 CellChangeTimes->{{3.634311059806551*^9, 3.6343110619107723`*^9}, {
  3.634342853052717*^9, 3.63434285322226*^9}}],

Cell["Check this satisfies the definition", "Text",
 CellChangeTimes->{{3.634342751939019*^9, 3.634342756322907*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ProductIdentity", "[", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{"Array", "[", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "]"}], ".", 
   RowBox[{"Vec", "[", 
    RowBox[{"Array", "[", 
     RowBox[{"b", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "]"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "-", 
   RowBox[{"Vec", "[", 
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"b", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], ".", 
     RowBox[{"Array", "[", 
      RowBox[{"c", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6343427228192253`*^9, 3.634342849022607*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"1", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"1", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"b", "[", 
         RowBox[{"2", ",", "2"}], "]"}], " ", 
        RowBox[{"c", "[", 
         RowBox[{"2", ",", "2"}], "]"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6343427370742683`*^9, 3.634342849570039*^9}, {
  3.63637910787423*^9, 3.636379116934216*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343427370742683`*^9, 3.634342849570039*^9}, {
  3.63637910787423*^9, 3.636379116940688*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Changing Vec Basis", "Subsection",
 CellChangeTimes->{{3.6343109399484663`*^9, 3.6343109519416733`*^9}}],

Cell[TextData[{
 StyleBox["BasisMatrix[\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]\
\[Rule]", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "returns the change of basis unitary matrix for transforming an ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 "-partite matrix vectorized in ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " convention to the ",
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " vectorization convention. basis may be ",
 StyleBox["\[OpenCurlyDoubleQuote]Pauli\[CloseCurlyDoubleQuote]", "Input"],
 ", ",
 StyleBox["\[OpenCurlyDoubleQuote]PO\[CloseCurlyDoubleQuote]", "Input"],
 ", or a list of basis matrices ",
 StyleBox["{", "Input"],
 StyleBox["b1,...,bk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 ". If ",
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" is not specified then it is assumed to be 1.",
  FontWeight->"Plain"],
 " \n",
 StyleBox["BasisMatrix[", "Input"],
 StyleBox["basis", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[Rule]\[CloseCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote], ", 
  "Input"],
 StyleBox["n", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["]", "Input"],
 " returns the inverse basis transformation matrix. \n",
 StyleBox["\nBasisMatrix[\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]\
\[Rule]\[CloseCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote],{", "Input"],
 StyleBox["dL", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dR", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}] ", "Input"],
 "returns the change of basis unitary matrix for transforming a ",
 StyleBox["{", "Input"],
 StyleBox["dL", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dR", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 " dimensional matrix vectorized in ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote]", "Input"],
 " convention to ",
 StyleBox["\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]", "Input"],
 " convention.\n",
 StyleBox["BasisMatrix[\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote]\
\[Rule]\[CloseCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote],{", "Input"],
 StyleBox["dL", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[",", "Input"],
 StyleBox["dR", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}]", "Input"],
 " returns the inverse transformation matrix."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311025702045*^9, {3.634342886453363*^9, 3.634342907599017*^9}, {
   3.6343442189163322`*^9, 3.6343442211062202`*^9}, {3.6343442615011044`*^9, 
   3.634344335922759*^9}, {3.634344384498783*^9, 3.634344464131016*^9}, {
   3.63434456180206*^9, 3.634344598138336*^9}, {3.6343446368820143`*^9, 
   3.634344774418923*^9}, {3.634344811140554*^9, 3.6343449489110613`*^9}, {
   3.634345022440645*^9, 3.6343450441723833`*^9}, 3.634345091797738*^9, {
   3.634345240846065*^9, 3.634345450190198*^9}},
 CellTags->"BasisMatrix::usage"],

Cell[TextData[{
 StyleBox["BasisTransformation[", "Input"],
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[", ", "Input"],
 StyleBox["basis1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["\[Rule]", "Input"],
 StyleBox["basis2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["] ", "Input"],
 "transforms an operator in vectorization ",
 StyleBox["basis1", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " to an operator in vectorization ",
 StyleBox["basis2", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 ". ",
 StyleBox["op", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 " may be a matrix which acts on vectorized matrices, or a vectorized matrix. \
Allowed bases are ",
 StyleBox["\[OpenCurlyDoubleQuote]Col\[CloseCurlyDoubleQuote],\
\[OpenCurlyDoubleQuote]Row\[CloseCurlyDoubleQuote],\[OpenCurlyDoubleQuote]\
Pauli\[CloseCurlyDoubleQuote],\[OpenCurlyDoubleQuote]PO\
\[CloseCurlyDoubleQuote]", "Input"],
 " or a basis specified by a list of basis matrices ",
 StyleBox["{", "Input"],
 StyleBox["b1,...,bk", "Input",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["}", "Input"],
 "."
}], "Text",
 CellDingbat->"\[FilledSquare]",
 CellChangeTimes->{
  3.634311013135188*^9, {3.634343515726198*^9, 3.63434351646231*^9}, {
   3.634343551183639*^9, 3.634343634962907*^9}, {3.634344189249134*^9, 
   3.6343441908562603`*^9}},
 CellTags->"BasisTransformation::usage"],

Cell[CellGroupData[{

Cell["Example 1", "Subsubsection",
 CellChangeTimes->{{3.6343438784149303`*^9, 3.63434387995182*^9}}],

Cell["\<\
Change of basis matrix for changing from \[OpenCurlyDoubleQuote]Col\
\[CloseCurlyDoubleQuote] vectorization to \[OpenCurlyDoubleQuote]Pauli\
\[CloseCurlyDoubleQuote] vectorization:\
\>", "Text",
 CellChangeTimes->{{3.6343440867532587`*^9, 3.634344103657028*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634343909872642*^9, 3.634343924769537*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      FractionBox["1", 
       SqrtBox["2"]]},
     {"0", 
      FractionBox["1", 
       SqrtBox["2"]], 
      FractionBox["1", 
       SqrtBox["2"]], "0"},
     {"0", 
      RowBox[{"-", 
       FractionBox["\[ImaginaryI]", 
        SqrtBox["2"]]}], 
      FractionBox["\[ImaginaryI]", 
       SqrtBox["2"]], "0"},
     {
      FractionBox["1", 
       SqrtBox["2"]], "0", "0", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.634343919673689*^9, 3.634343925361484*^9}, {
  3.636379107909432*^9, 3.63637911698279*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], "]"}], ".", 
  RowBox[{"Vec", "[", 
   RowBox[{"TP", "[", "I", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634343929412682*^9, 3.6343439323039627`*^9}, {
  3.634344055055409*^9, 3.634344055429455*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    SqrtBox["2"], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634343932724279*^9, 3.6343440560172377`*^9, {3.636379110140234*^9, 
   3.636379117046517*^9}}]
}, Open  ]],

Cell["For changing a system of 2-qubits to Pauli vectorization", "Text",
 CellChangeTimes->{{3.6343439933172817`*^9, 3.63434401866851*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{
    RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], ",", "2"}], "]"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.634343970815525*^9, 3.634343970959241*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SqrtBox["2"], "0", "0", 
      SqrtBox["2"]},
     {"0", 
      SqrtBox["2"], 
      SqrtBox["2"], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SqrtBox["2"]}], 
      RowBox[{"\[ImaginaryI]", " ", 
       SqrtBox["2"]}], "0"},
     {
      SqrtBox["2"], "0", "0", 
      RowBox[{"-", 
       SqrtBox["2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {4, 4}, 0, {
     1, {{0, 2, 4, 6, 8}, {{1}, {4}, {2}, {3}, {2}, {3}, {1}, {4}}}, {
      2^Rational[1, 2], 2^Rational[1, 2], 2^Rational[1, 2], 2^Rational[1, 2], 
       Complex[0, -1] 2^Rational[1, 2], Complex[0, 1] 2^Rational[1, 2], 2^
       Rational[1, 2], -2^Rational[1, 2]}}]]]]], "Output",
 CellChangeTimes->{
  3.6343439713560343`*^9, {3.636379110225204*^9, 3.636379117072016*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasisMatrix", "[", 
   RowBox[{
    RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}], ",", "2"}], "]"}], 
  ".", 
  RowBox[{"Vec", "[", 
   RowBox[{"TP", "[", "II", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.634344025887267*^9, 3.6343440361013813`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Dot", "::", "dotsh"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tensors \
\[NoBreak]\\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \\(\\({4, 4}\\)\\), \
0, \\(\\({1, \\(\\({\\(\\({0, 2, 4, 6, 8}\\)\\), \\(\\({\\(\\({1}\\)\\), \
\\(\\({4}\\)\\), \\(\\({2}\\)\\), \\(\\({3}\\)\\), \\(\\({2}\\)\\), \\(\\({3}\
\\)\\), \\(\\({1}\\)\\), \\(\\({4}\\)\\)}\\)\\)}\\)\\), \\(\\({\\@2, \\@2, \
\\@2, \\@2, \\(\\(\\(\\(-\[ImaginaryI]\\)\\)\\\\ \\@2\\)\\), \\(\\(\
\[ImaginaryI]\\\\ \\@2\\)\\), \\@2, \
\\(\\(-\\@2\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, False], \
Rule[SelectWithContents, True]]\\)\[NoBreak] and \
\[NoBreak]\\!\\({\\(\\({1}\\)\\), \\(\\({0}\\)\\), \\(\\({0}\\)\\), \\(\\({0}\
\\)\\), \\(\\({0}\\)\\), \\(\\({1}\\)\\), \\(\\({0}\\)\\), \\(\\({0}\\)\\), \
\\(\\({0}\\)\\), \\(\\({0}\\)\\), \\(\\({1}\\)\\), \\(\\({0}\\)\\), \\(\\({0}\
\\)\\), \\(\\({0}\\)\\), \\(\\({0}\\)\\), \\(\\({1}\\)\\)}\\)\[NoBreak] have \
incompatible shapes. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.636379110355742*^9, 3.636379117211997*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   TemplateBox[{RowBox[{
       StyleBox[
        TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
       StyleBox["[", "NonInterpretableSummary"], 
       DynamicModuleBox[{Typeset`open$$ = False}, 
        PanelBox[
         PaneSelectorBox[{False -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SquarePlusIconMedium"]], 
                 ButtonFunction :> (Typeset`open$$ = True), Appearance -> 
                 None, Evaluator -> Automatic, Method -> "Preemptive"], 
                Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 3.5 CurrentValue["FontCapHeight"]/
                   AbsoluteCurrentValue[Magnification]}]], 
               GraphicsBox[
                RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBggWIQe2e3gevOLS/sb7gvX1cz7a39yYjcf/Ff39tble+O
m6V0zn6O8aIt5j+u2L9YpPg4cNUrnOIK70O1heuO2jNAgciWkw8n+10m2Rxq
iePyF6n+pVb44DIHAMPgzjo=
                 "], {{0, 0}, {4, 4}}, {0, 1}], 
                AspectRatio -> 1, Axes -> False, Frame -> False, 
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                  Opacity[0.5], 
                  Thickness[Tiny], 
                  RGBColor[0.368417, 0.506779, 0.709798]], 
                FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
                Directive[
                  GrayLevel[0.5, 0.4]], ImageSize -> 
                Dynamic[{
                  Automatic, 3.5 CurrentValue["FontCapHeight"]/
                   AbsoluteCurrentValue[Magnification]}], 
                Method -> {
                 "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                  Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                  Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
               GridBox[{{
                  RowBox[{
                    TagBox[
                    "\"Specified elements: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["8", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}], True -> GridBox[{{
               PaneBox[
                ButtonBox[
                 DynamicBox[
                  FEPrivate`FrontEndResource[
                  "FEBitmaps", "SquareMinusIconMedium"]], 
                 ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                 None, Evaluator -> Automatic, Method -> "Preemptive"], 
                Alignment -> {Center, Center}, ImageSize -> 
                Dynamic[{
                  Automatic, 3.5 CurrentValue["FontCapHeight"]/
                   AbsoluteCurrentValue[Magnification]}]], 
               GraphicsBox[
                RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBggWIQe2e3gevOLS/sb7gvX1cz7a39yYjcf/Ff39tble+O
m6V0zn6O8aIt5j+u2L9YpPg4cNUrnOIK70O1heuO2jNAgciWkw8n+10m2Rxq
iePyF6n+pVb44DIHAMPgzjo=
                 "], {{0, 0}, {4, 4}}, {0, 1}], 
                AspectRatio -> 1, Axes -> False, Frame -> False, 
                FrameLabel -> {None, None}, FrameStyle -> Directive[
                  Opacity[0.5], 
                  Thickness[Tiny], 
                  RGBColor[0.368417, 0.506779, 0.709798]], 
                FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
                Directive[
                  GrayLevel[0.5, 0.4]], ImageSize -> 
                Dynamic[{
                  Automatic, 3.5 CurrentValue["FontCapHeight"]/
                   AbsoluteCurrentValue[Magnification]}], 
                Method -> {
                 "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                  Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                  Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
               GridBox[{{
                  RowBox[{
                    TagBox[
                    "\"Specified elements: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["8", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox[
                    RowBox[{"{", 
                    RowBox[{"4", ",", "4"}], "}"}], "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["0", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["0.5`", "SummaryItem"]}]}, {
                  RowBox[{
                    TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                    "\[InvisibleSpace]", 
                    TagBox["\"\"", "SummaryItem"]}]}, {
                  TagBox[
                   TagBox[
                    GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    SqrtBox["2"], ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "4"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    SqrtBox["2"], ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    SqrtBox["2"], ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    SqrtBox["2"], ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], "SummaryItem"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {
                 "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
                BaseStyle -> {
                 ShowStringCharacters -> False, NumberMarks -> False, 
                  PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
             GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             BaselinePosition -> {1, 1}]}, 
          Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
         Baseline], DynamicModuleValues :> {}], 
       StyleBox["]", "NonInterpretableSummary"]}]},
    "CopyTag",
    DisplayFunction->(#& ),
    InterpretationFunction->("SparseArray[<8>, {4, 4}]"& )],
   False,
   Editable->False,
   SelectWithContents->True,
   Selectable->False], ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "1", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "0", "}"}], ",", 
    RowBox[{"{", "1", "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{{3.634344032334811*^9, 3.634344036782835*^9}, {
  3.636379110476276*^9, 3.636379117308957*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example 2", "Subsubsection",
 CellChangeTimes->{{3.634311079023025*^9, 3.634311079944573*^9}, {
  3.6343438732238092`*^9, 3.6343438734067183`*^9}}],

Cell["\<\
Transforming a col-vectorized Pauli-matrix into the Pauli vectorization basis:\
\>", "Text",
 CellChangeTimes->{{3.634343791707954*^9, 3.634343795964477*^9}, {
  3.634343834047625*^9, 3.634343856720357*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BasisTransformation", "[", 
  RowBox[{
   RowBox[{"Vec", "[", 
    RowBox[{"TP", "[", "X", "]"}], "]"}], ",", 
   RowBox[{"\"\<Col\>\"", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.634343696032118*^9, 3.634343785722336*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    SqrtBox["2"], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6343437510755177`*^9, 3.634343786873967*^9}, {
  3.6363791104884987`*^9, 3.636379117330377*^9}}]
}, Open  ]],

Cell["Compare this to straight vectorization in the Pauli basis", "Text",
 CellChangeTimes->{{3.634343801892969*^9, 3.6343438151893263`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", "[", 
  RowBox[{
   RowBox[{"TP", "[", "X", "]"}], ",", 
   RowBox[{"Basis", "\[Rule]", "\"\<Pauli\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.634343816255982*^9, 3.634343825174858*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    SqrtBox["2"], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.634343828610881*^9, {3.636379110499968*^9, 3.63637911736308*^9}}]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{873, 998},
WindowMargins->{{393, Automatic}, {Automatic, 52}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "CircleTimes::usage"->{
  Cell[2856, 87, 2459, 81, 213, "Text",
   CellTags->"CircleTimes::usage"]},
 "IdentityMatrixShorthand::usage"->{
  Cell[9113, 288, 1579, 40, 74, "Text",
   CellTags->"IdentityMatrixShorthand::usage"]},
 "TensorFactorPermutations::usage"->{
  Cell[12879, 400, 1756, 59, 114, "Text",
   CellTags->"TensorFactorPermutations::usage"]},
 "SwapMatrix::usage"->{
  Cell[18822, 574, 1967, 72, 175, "Text",
   CellTags->"SwapMatrix::usage"]},
 "BlockMatrix::usage"->{
  Cell[22248, 698, 538, 17, 32, "Text",
   CellTags->"BlockMatrix::usage"]},
 "UnitArray::usage"->{
  Cell[25398, 805, 1195, 43, 74, "Text",
   CellTags->"UnitArray::usage"]},
 "Com::usage"->{
  Cell[28058, 901, 3508, 143, 74, "Text",
   CellTags->"Com::usage"]},
 "ACom::usage"->{
  Cell[31569, 1046, 3428, 141, 74, "Text",
   CellTags->"ACom::usage"]},
 "OuterProduct::usage"->{
  Cell[37517, 1273, 1955, 67, 114, "Text",
   CellTags->"OuterProduct::usage"]},
 "Projector::usage"->{
  Cell[54491, 1829, 1522, 51, 152, "Text",
   CellTags->"Projector::usage"]},
 "TP::usage"->{
  Cell[69841, 2255, 3801, 106, 439, "Text",
   CellTags->"TP::usage"]},
 "MatrixToTensor::usage"->{
  Cell[80155, 2571, 2617, 103, 175, "Text",
   CellTags->"MatrixToTensor::usage"]},
 "MatrixTranspose::usage"->{
  Cell[89312, 2894, 1325, 37, 136, "Text",
   CellTags->"MatrixTranspose::usage"]},
 "Swap::usage"->{
  Cell[96813, 3138, 3005, 118, 154, "Text",
   CellTags->"Swap::usage"]},
 "Reshuffle::usage"->{
  Cell[108914, 3559, 3277, 111, 315, "Text",
   CellTags->"Reshuffle::usage"]},
 "Unravel::usage"->{
  Cell[116200, 3798, 2935, 105, 213, "Text",
   CellTags->"Unravel::usage"]},
 "Reravel::usage"->{
  Cell[121716, 3985, 2360, 86, 154, "Text",
   CellTags->"Reravel::usage"]},
 "PartialTr::usage"->{
  Cell[125307, 4116, 2042, 70, 135, "Text",
   CellTags->"PartialTr::usage"]},
 "TensorPairContract::usage"->{
  Cell[132983, 4370, 1417, 52, 74, "Text",
   CellTags->"TensorPairContract::usage"]},
 "MatrixContract::usage"->{
  Cell[135845, 4475, 1859, 65, 133, "Text",
   CellTags->"MatrixContract::usage"]},
 "MatrixPairContract::usage"->{
  Cell[139958, 4621, 1871, 67, 135, "Text",
   CellTags->"MatrixPairContract::usage"]},
 "Basis::usage"->{
  Cell[143946, 4760, 2584, 79, 215, "Text",
   CellTags->"Basis::usage"]},
 "BasisLabels::usage"->{
  Cell[180981, 5870, 3291, 101, 320, "Text",
   CellTags->"BasisLabels::usage"]},
 "ExpressInBasis::usage"->{
  Cell[202588, 6487, 2561, 82, 259, "Text",
   CellTags->"ExpressInBasis::usage"]},
 "Vec::usage"->{
  Cell[228853, 7268, 1718, 50, 155, "Text",
   CellTags->"Vec::usage"]},
 "Devec::usage"->{
  Cell[237707, 7552, 1688, 49, 155, "Text",
   CellTags->"Devec::usage"]},
 "ProductIdentity::usage"->{
  Cell[244815, 7781, 2100, 67, 155, "Text",
   CellTags->"ProductIdentity::usage"]},
 "BasisMatrix::usage"->{
  Cell[253646, 8065, 3385, 95, 178, "Text",
   CellTags->"BasisMatrix::usage"]},
 "BasisTransformation::usage"->{
  Cell[257034, 8162, 1482, 45, 74, "Text",
   CellTags->"BasisTransformation::usage"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"CircleTimes::usage", 276599, 8675},
 {"IdentityMatrixShorthand::usage", 276713, 8678},
 {"TensorFactorPermutations::usage", 276840, 8681},
 {"SwapMatrix::usage", 276956, 8684},
 {"BlockMatrix::usage", 277059, 8687},
 {"UnitArray::usage", 277159, 8690},
 {"Com::usage", 277252, 8693},
 {"ACom::usage", 277341, 8696},
 {"OuterProduct::usage", 277440, 8699},
 {"Projector::usage", 277544, 8702},
 {"TP::usage", 277638, 8705},
 {"MatrixToTensor::usage", 277738, 8708},
 {"MatrixTranspose::usage", 277851, 8711},
 {"Swap::usage", 277953, 8714},
 {"Reshuffle::usage", 278050, 8717},
 {"Unravel::usage", 278151, 8720},
 {"Reravel::usage", 278250, 8723},
 {"PartialTr::usage", 278350, 8726},
 {"TensorPairContract::usage", 278461, 8729},
 {"MatrixContract::usage", 278576, 8732},
 {"MatrixPairContract::usage", 278692, 8735},
 {"Basis::usage", 278799, 8738},
 {"BasisLabels::usage", 278899, 8741},
 {"ExpressInBasis::usage", 279009, 8744},
 {"Vec::usage", 279110, 8747},
 {"Devec::usage", 279202, 8750},
 {"ProductIdentity::usage", 279306, 8753},
 {"BasisMatrix::usage", 279416, 8756},
 {"BasisTransformation::usage", 279530, 8759}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 300, 4, 66, "Chapter"],
Cell[CellGroupData[{
Cell[905, 30, 98, 1, 44, "Subsection"],
Cell[1006, 33, 331, 5, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1374, 43, 101, 1, 36, "Subsection"],
Cell[1478, 46, 531, 12, 39, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[2046, 63, 110, 1, 51, "Section"],
Cell[2159, 66, 316, 6, 51, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2512, 77, 215, 3, 65, "Section"],
Cell[CellGroupData[{
Cell[2752, 84, 101, 1, 44, "Subsection"],
Cell[2856, 87, 2459, 81, 213, "Text",
 CellTags->"CircleTimes::usage"],
Cell[CellGroupData[{
Cell[5340, 172, 102, 1, 35, "Subsubsection"],
Cell[5445, 175, 111, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[5581, 180, 222, 6, 32, "Input"],
Cell[5806, 188, 260, 5, 70, "Output"]
}, Open  ]],
Cell[6081, 196, 109, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[6215, 201, 322, 8, 32, "Input"],
Cell[6540, 211, 1120, 26, 70, "Output"]
}, Open  ]],
Cell[7675, 240, 169, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[7869, 246, 291, 7, 32, "Input"],
Cell[8163, 255, 735, 22, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[8959, 284, 151, 2, 37, "Subsection"],
Cell[9113, 288, 1579, 40, 74, "Text",
 CellTags->"IdentityMatrixShorthand::usage"],
Cell[CellGroupData[{
Cell[10717, 332, 98, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[10840, 337, 133, 2, 32, "Input"],
Cell[10976, 341, 451, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11464, 358, 281, 6, 32, "Input"],
Cell[11748, 366, 831, 22, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[12640, 395, 236, 3, 36, "Subsection"],
Cell[12879, 400, 1756, 59, 114, "Text",
 CellTags->"TensorFactorPermutations::usage"],
Cell[CellGroupData[{
Cell[14660, 463, 98, 1, 35, "Subsubsection"],
Cell[14761, 466, 191, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[14977, 473, 489, 13, 46, "Input"],
Cell[15469, 488, 1071, 25, 70, "Output"]
}, Open  ]],
Cell[16555, 516, 164, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[16744, 522, 645, 15, 46, "Input"],
Cell[17392, 539, 621, 11, 70, "Output"],
Cell[18016, 552, 619, 11, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[18696, 570, 123, 2, 37, "Subsection"],
Cell[18822, 574, 1967, 72, 175, "Text",
 CellTags->"SwapMatrix::usage"],
Cell[CellGroupData[{
Cell[20814, 650, 98, 1, 35, "Subsubsection"],
Cell[20915, 653, 99, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[21039, 658, 239, 6, 28, "Input"],
Cell[21281, 666, 774, 21, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[22116, 694, 129, 2, 36, "Subsection"],
Cell[22248, 698, 538, 17, 32, "Text",
 CellTags->"BlockMatrix::usage"],
Cell[CellGroupData[{
Cell[22811, 719, 100, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[22936, 724, 545, 17, 28, "Input"],
Cell[23484, 743, 1704, 51, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[25249, 801, 146, 2, 37, "Subsection"],
Cell[25398, 805, 1195, 43, 74, "Text",
 CellTags->"UnitArray::usage"],
Cell[CellGroupData[{
Cell[26618, 852, 99, 1, 35, "Subsubsection"],
Cell[26720, 855, 99, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[26844, 860, 289, 8, 28, "Input"],
Cell[27136, 870, 709, 20, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[27906, 897, 149, 2, 36, "Subsection"],
Cell[28058, 901, 3508, 143, 74, "Text",
 CellTags->"Com::usage"],
Cell[31569, 1046, 3428, 141, 74, "Text",
 CellTags->"ACom::usage"],
Cell[CellGroupData[{
Cell[35022, 1191, 102, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[35149, 1196, 241, 6, 28, "Input"],
Cell[35393, 1204, 801, 22, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36231, 1231, 254, 7, 28, "Input"],
Cell[36488, 1240, 801, 22, 47, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[37350, 1269, 164, 2, 37, "Subsection"],
Cell[37517, 1273, 1955, 67, 114, "Text",
 CellTags->"OuterProduct::usage"],
Cell[CellGroupData[{
Cell[39497, 1344, 158, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[39680, 1350, 292, 8, 28, "Input"],
Cell[39975, 1360, 925, 26, 58, "Output"]
}, Open  ]],
Cell[40915, 1389, 111, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[41051, 1394, 403, 13, 28, "Input"],
Cell[41457, 1409, 925, 26, 58, "Output"]
}, Open  ]],
Cell[42397, 1438, 102, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[42524, 1443, 349, 11, 28, "Input"],
Cell[42876, 1456, 899, 26, 58, "Output"]
}, Open  ]],
Cell[43790, 1485, 171, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[43986, 1491, 349, 11, 28, "Input"],
Cell[44338, 1504, 953, 27, 58, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[45340, 1537, 161, 2, 29, "Subsubsection"],
Cell[45504, 1541, 275, 8, 30, "Text"],
Cell[CellGroupData[{
Cell[45804, 1553, 423, 13, 28, "Input"],
Cell[46230, 1568, 3830, 116, 92, "Output"]
}, Open  ]],
Cell[50075, 1687, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[50238, 1692, 367, 10, 28, "Input"],
Cell[50608, 1704, 3722, 115, 176, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[54391, 1826, 97, 1, 37, "Subsection"],
Cell[54491, 1829, 1522, 51, 152, "Text",
 CellTags->"Projector::usage"],
Cell[CellGroupData[{
Cell[56038, 1884, 162, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[56225, 1890, 262, 7, 28, "Input"],
Cell[56490, 1899, 1833, 53, 69, "Output"]
}, Open  ]],
Cell[58338, 1955, 127, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[58490, 1960, 237, 6, 28, "Input"],
Cell[58730, 1968, 7721, 159, 64, "Output"]
}, Open  ]],
Cell[66466, 2130, 115, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[66606, 2135, 510, 14, 28, "Input"],
Cell[67119, 2151, 625, 19, 47, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[67793, 2176, 110, 1, 29, "Subsubsection"],
Cell[67906, 2179, 249, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[68180, 2190, 357, 12, 28, "Input"],
Cell[68540, 2204, 997, 35, 47, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[69610, 2247, 106, 1, 51, "Section"],
Cell[CellGroupData[{
Cell[69741, 2252, 97, 1, 44, "Subsection"],
Cell[69841, 2255, 3801, 106, 439, "Text",
 CellTags->"TP::usage"],
Cell[CellGroupData[{
Cell[73667, 2365, 102, 1, 35, "Subsubsection"],
Cell[73772, 2368, 4126, 122, 323, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[77935, 2495, 147, 2, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[78107, 2501, 233, 5, 28, "Input"],
Cell[78343, 2508, 914, 26, 70, "Output"]
}, Open  ]],
Cell[79272, 2537, 163, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[79460, 2544, 166, 4, 28, "Input"],
Cell[79629, 2550, 207, 5, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[79909, 2563, 112, 1, 51, "Section"],
Cell[CellGroupData[{
Cell[80046, 2568, 106, 1, 44, "Subsection"],
Cell[80155, 2571, 2617, 103, 175, "Text",
 CellTags->"MatrixToTensor::usage"],
Cell[CellGroupData[{
Cell[82797, 2678, 98, 1, 35, "Subsubsection"],
Cell[82898, 2681, 158, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[83081, 2688, 486, 14, 46, "Input"],
Cell[83570, 2704, 2625, 81, 70, "Output"],
Cell[86198, 2787, 147, 2, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[86394, 2795, 102, 1, 29, "Subsubsection"],
Cell[86499, 2798, 125, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[86649, 2803, 378, 10, 46, "Input"],
Cell[87030, 2815, 1991, 65, 70, "Output"],
Cell[89024, 2882, 121, 2, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[89206, 2891, 103, 1, 37, "Subsection"],
Cell[89312, 2894, 1325, 37, 136, "Text",
 CellTags->"MatrixTranspose::usage"],
Cell[CellGroupData[{
Cell[90662, 2935, 102, 1, 35, "Subsubsection"],
Cell[90767, 2938, 159, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[90951, 2945, 651, 19, 46, "Input"],
Cell[91605, 2966, 3192, 101, 70, "Output"]
}, Open  ]],
Cell[94812, 3070, 97, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[94934, 3075, 946, 30, 65, "Input"],
Cell[95883, 3107, 776, 21, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[96720, 3135, 90, 1, 37, "Subsection"],
Cell[96813, 3138, 3005, 118, 154, "Text",
 CellTags->"Swap::usage"],
Cell[CellGroupData[{
Cell[99843, 3260, 149, 2, 35, "Subsubsection"],
Cell[99995, 3264, 101, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[100121, 3269, 568, 17, 46, "Input"],
Cell[100692, 3288, 6324, 203, 70, "Output"]
}, Open  ]],
Cell[107031, 3494, 111, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[107167, 3499, 818, 26, 46, "Input"],
Cell[107988, 3527, 763, 22, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[108812, 3556, 99, 1, 36, "Subsection"],
Cell[108914, 3559, 3277, 111, 315, "Text",
 CellTags->"Reshuffle::usage"],
Cell[CellGroupData[{
Cell[112216, 3674, 98, 1, 35, "Subsubsection"],
Cell[112317, 3677, 1048, 25, 101, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[113402, 3707, 100, 1, 29, "Subsubsection"],
Cell[113505, 3710, 153, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[113683, 3717, 575, 17, 46, "Input"],
Cell[114261, 3736, 511, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114809, 3753, 697, 20, 46, "Input"],
Cell[115509, 3775, 532, 13, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[116102, 3795, 95, 1, 36, "Subsection"],
Cell[116200, 3798, 2935, 105, 213, "Text",
 CellTags->"Unravel::usage"],
Cell[CellGroupData[{
Cell[119160, 3907, 98, 1, 35, "Subsubsection"],
Cell[119261, 3910, 983, 25, 99, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[120281, 3940, 98, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[120404, 3945, 786, 21, 46, "Input"],
Cell[121193, 3968, 364, 7, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[121618, 3982, 95, 1, 36, "Subsection"],
Cell[121716, 3985, 2360, 86, 154, "Text",
 CellTags->"Reravel::usage"],
Cell[CellGroupData[{
Cell[124101, 4075, 99, 1, 35, "Subsubsection"],
Cell[124203, 4078, 124, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[124352, 4083, 302, 8, 28, "Input"],
Cell[124657, 4093, 339, 7, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[125069, 4108, 111, 1, 51, "Section"],
Cell[CellGroupData[{
Cell[125205, 4113, 99, 1, 44, "Subsection"],
Cell[125307, 4116, 2042, 70, 135, "Text",
 CellTags->"PartialTr::usage"],
Cell[CellGroupData[{
Cell[127374, 4190, 102, 1, 35, "Subsubsection"],
Cell[127479, 4193, 200, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[127704, 4201, 449, 12, 28, "Input"],
Cell[128156, 4215, 3215, 101, 70, "Output"]
}, Open  ]],
Cell[131386, 4319, 144, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[131555, 4324, 452, 12, 28, "Input"],
Cell[132010, 4338, 803, 22, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[132874, 4367, 106, 1, 36, "Subsection"],
Cell[132983, 4370, 1417, 52, 74, "Text",
 CellTags->"TensorPairContract::usage"],
Cell[CellGroupData[{
Cell[134425, 4426, 100, 1, 35, "Subsubsection"],
Cell[134528, 4429, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[134692, 4434, 863, 27, 63, "Input"],
Cell[135558, 4463, 119, 2, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[135738, 4472, 104, 1, 36, "Subsection"],
Cell[135845, 4475, 1859, 65, 133, "Text",
 CellTags->"MatrixContract::usage"],
Cell[CellGroupData[{
Cell[137729, 4544, 100, 1, 35, "Subsubsection"],
Cell[137832, 4547, 162, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[138019, 4554, 447, 14, 46, "Input"],
Cell[138469, 4570, 1318, 41, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[139848, 4618, 107, 1, 36, "Subsection"],
Cell[139958, 4621, 1871, 67, 135, "Text",
 CellTags->"MatrixPairContract::usage"],
Cell[CellGroupData[{
Cell[141854, 4692, 99, 1, 35, "Subsubsection"],
Cell[141956, 4695, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[142120, 4700, 1308, 38, 97, "Input"],
Cell[143431, 4740, 220, 4, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[143724, 4752, 101, 1, 51, "Section"],
Cell[CellGroupData[{
Cell[143850, 4757, 93, 1, 44, "Subsection"],
Cell[143946, 4760, 2584, 79, 215, "Text",
 CellTags->"Basis::usage"],
Cell[CellGroupData[{
Cell[146555, 4843, 222, 3, 35, "Subsubsection"],
Cell[146780, 4848, 115, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[146920, 4853, 220, 4, 32, "Input"],
Cell[147143, 4859, 3138, 92, 74, "Output"]
}, Open  ]],
Cell[150296, 4954, 122, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[150443, 4959, 194, 4, 32, "Input"],
Cell[150640, 4965, 11973, 334, 238, "Output"]
}, Open  ]],
Cell[162628, 5302, 124, 1, 31, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[162789, 5308, 167, 2, 29, "Subsubsection"],
Cell[162959, 5312, 611, 19, 62, "Text"],
Cell[163573, 5333, 646, 18, 55, "Input"],
Cell[164222, 5353, 178, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[164425, 5359, 320, 7, 32, "Input"],
Cell[164748, 5368, 9045, 265, 414, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[173842, 5639, 216, 3, 29, "Subsubsection"],
Cell[174061, 5644, 211, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[174297, 5652, 513, 15, 32, "Input"],
Cell[174813, 5669, 1711, 52, 72, "Output"]
}, Open  ]],
Cell[176539, 5724, 170, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[176734, 5730, 552, 17, 32, "Input"],
Cell[177289, 5749, 3529, 111, 124, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[180879, 5867, 99, 1, 36, "Subsection"],
Cell[180981, 5870, 3291, 101, 320, "Text",
 CellTags->"BasisLabels::usage"],
Cell[CellGroupData[{
Cell[184297, 5975, 98, 1, 35, "Subsubsection"],
Cell[184398, 5978, 1040, 26, 81, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[185475, 6009, 161, 2, 29, "Subsubsection"],
Cell[185639, 6013, 122, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[185786, 6018, 164, 3, 28, "Input"],
Cell[185953, 6023, 1203, 20, 28, "Output"]
}, Open  ]],
Cell[187171, 6046, 109, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[187305, 6051, 209, 4, 28, "Input"],
Cell[187517, 6057, 415, 7, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187969, 6069, 207, 4, 28, "Input"],
Cell[188179, 6075, 1375, 35, 46, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[189603, 6116, 114, 1, 29, "Subsubsection"],
Cell[189720, 6119, 272, 9, 43, "Text"],
Cell[CellGroupData[{
Cell[190017, 6132, 169, 3, 32, "Input"],
Cell[190189, 6137, 1498, 36, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191724, 6178, 213, 4, 32, "Input"],
Cell[191940, 6184, 751, 19, 48, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[192740, 6209, 112, 1, 29, "Subsubsection"],
Cell[192855, 6212, 721, 25, 54, "Text"],
Cell[CellGroupData[{
Cell[193601, 6241, 220, 5, 32, "Input"],
Cell[193824, 6248, 1290, 20, 99, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[195163, 6274, 142, 2, 29, "Subsubsection"],
Cell[195308, 6278, 135, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[195468, 6283, 243, 6, 32, "Input"],
Cell[195714, 6291, 706, 13, 32, "Output"]
}, Open  ]],
Cell[196435, 6307, 109, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[196569, 6312, 264, 7, 32, "Input"],
Cell[196836, 6321, 1399, 35, 55, "Output"]
}, Open  ]],
Cell[198250, 6359, 153, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[198428, 6366, 312, 8, 32, "Input"],
Cell[198743, 6376, 512, 10, 23, "Message"],
Cell[199258, 6388, 512, 10, 23, "Message"],
Cell[199773, 6400, 510, 10, 23, "Message"],
Cell[200286, 6412, 535, 11, 23, "Message"],
Cell[200824, 6425, 501, 15, 32, "Output"]
}, Open  ]],
Cell[201340, 6443, 142, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[201507, 6448, 310, 8, 32, "Input"],
Cell[201820, 6458, 603, 19, 32, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[202484, 6484, 101, 1, 37, "Subsection"],
Cell[202588, 6487, 2561, 82, 259, "Text",
 CellTags->"ExpressInBasis::usage"],
Cell[CellGroupData[{
Cell[205174, 6573, 100, 1, 35, "Subsubsection"],
Cell[205277, 6576, 2234, 53, 227, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[207548, 6634, 155, 2, 29, "Subsubsection"],
Cell[207706, 6638, 124, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[207855, 6643, 280, 8, 28, "Input"],
Cell[208138, 6653, 8551, 252, 424, "Output"]
}, Open  ]],
Cell[216704, 6908, 117, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[216846, 6913, 354, 10, 28, "Input"],
Cell[217203, 6925, 9225, 267, 424, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[226477, 7198, 102, 1, 29, "Subsubsection"],
Cell[226582, 7201, 190, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[226797, 7209, 323, 7, 28, "Input"],
Cell[227123, 7218, 199, 5, 28, "Output"]
}, Open  ]],
Cell[227337, 7226, 153, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[227515, 7232, 224, 5, 28, "Input"],
Cell[227742, 7239, 770, 12, 46, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[228585, 7259, 98, 1, 51, "Section"],
Cell[CellGroupData[{
Cell[228708, 7264, 142, 2, 44, "Subsection"],
Cell[228853, 7268, 1718, 50, 155, "Text",
 CellTags->"Vec::usage"],
Cell[CellGroupData[{
Cell[230596, 7322, 98, 1, 35, "Subsubsection"],
Cell[230697, 7325, 1364, 32, 139, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[232098, 7362, 149, 2, 29, "Subsubsection"],
Cell[232250, 7366, 168, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[232443, 7372, 269, 8, 28, "Input"],
Cell[232715, 7382, 960, 29, 70, "Output"]
}, Open  ]],
Cell[233690, 7414, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[233853, 7419, 344, 10, 28, "Input"],
Cell[234200, 7431, 932, 29, 70, "Output"]
}, Open  ]],
Cell[235147, 7463, 182, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[235354, 7469, 344, 10, 28, "Input"],
Cell[235701, 7481, 1750, 59, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[237512, 7547, 192, 3, 36, "Subsection"],
Cell[237707, 7552, 1688, 49, 155, "Text",
 CellTags->"Devec::usage"],
Cell[CellGroupData[{
Cell[239420, 7605, 98, 1, 35, "Subsubsection"],
Cell[239521, 7608, 120, 1, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239678, 7614, 149, 2, 35, "Subsubsection"],
Cell[239830, 7618, 202, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[240057, 7626, 266, 6, 28, "Input"],
Cell[240326, 7634, 857, 23, 70, "Output"]
}, Open  ]],
Cell[241198, 7660, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[241361, 7665, 342, 9, 28, "Input"],
Cell[241706, 7676, 832, 24, 70, "Output"]
}, Open  ]],
Cell[242553, 7703, 182, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[242760, 7709, 340, 9, 28, "Input"],
Cell[243103, 7720, 1520, 50, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[244684, 7777, 128, 2, 37, "Subsection"],
Cell[244815, 7781, 2100, 67, 155, "Text",
 CellTags->"ProductIdentity::usage"],
Cell[CellGroupData[{
Cell[246940, 7852, 98, 1, 35, "Subsubsection"],
Cell[247041, 7855, 93, 1, 30, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[247171, 7861, 148, 2, 29, "Subsubsection"],
Cell[247322, 7865, 117, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[247464, 7870, 1114, 36, 80, "Input"],
Cell[248581, 7908, 4583, 137, 70, "Output"],
Cell[253167, 8047, 305, 8, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[253533, 8062, 110, 1, 37, "Subsection"],
Cell[253646, 8065, 3385, 95, 178, "Text",
 CellTags->"BasisMatrix::usage"],
Cell[257034, 8162, 1482, 45, 74, "Text",
 CellTags->"BasisTransformation::usage"],
Cell[CellGroupData[{
Cell[258541, 8211, 101, 1, 35, "Subsubsection"],
Cell[258645, 8214, 272, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[258942, 8223, 218, 5, 28, "Input"],
Cell[259163, 8230, 1181, 39, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260381, 8274, 316, 7, 28, "Input"],
Cell[260700, 8283, 322, 10, 70, "Output"]
}, Open  ]],
Cell[261037, 8296, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[261201, 8301, 243, 6, 28, "Input"],
Cell[261447, 8309, 1309, 39, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262793, 8353, 296, 8, 28, "Input"],
Cell[263092, 8363, 1284, 22, 70, "Message"],
Cell[264379, 8387, 10113, 212, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[274541, 8605, 153, 2, 29, "Subsubsection"],
Cell[274697, 8609, 217, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[274939, 8617, 275, 6, 28, "Input"],
Cell[275217, 8625, 322, 9, 70, "Output"]
}, Open  ]],
Cell[275554, 8637, 141, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[275720, 8642, 221, 5, 28, "Input"],
Cell[275944, 8649, 293, 9, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
